<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>The wonderful world of recommender systems | Yanir Seroussi | Data science and beyond</title>
<meta name=keywords content="data science,machine learning,predictive modelling,recommender systems,software engineering">
<meta name=description content="I recently gave a talk about recommender systems at the Data Science Sydney meetup (the slides are available here). This post roughly follows the outline of the talk, expanding on some of the key points in non-slide form (i.e., complete sentences and paragraphs!). The first few sections give a broad overview of the field and the common recommendation paradigms, while the final part is dedicated to debunking five common myths about recommender systems.">
<meta name=author content="Yanir Seroussi">
<link rel=canonical href=https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/>
<link crossorigin=anonymous href=/yanirseroussi.com/assets/css/stylesheet.min.7603165cb47dcda1f46a839ca379731b2f33098c043e75f680940e69a5d546a8.css integrity="sha256-dgMWXLR9zaH0aoOco3lzGy8zCYwEPnX2gJQOaaXVRqg=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/yanirseroussi.com/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://yanirs.github.io/yanirseroussi.com/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://yanirs.github.io/yanirseroussi.com/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://yanirs.github.io/yanirseroussi.com/favicon-32x32.png>
<link rel=apple-touch-icon href=https://yanirs.github.io/yanirseroussi.com/apple-touch-icon.png>
<link rel=mask-icon href=https://yanirs.github.io/yanirseroussi.com/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.89.0">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><meta property="og:title" content="The wonderful world of recommender systems">
<meta property="og:description" content="I recently gave a talk about recommender systems at the Data Science Sydney meetup (the slides are available here). This post roughly follows the outline of the talk, expanding on some of the key points in non-slide form (i.e., complete sentences and paragraphs!). The first few sections give a broad overview of the field and the common recommendation paradigms, while the final part is dedicated to debunking five common myths about recommender systems.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/">
<meta property="og:image" content="https://yanirs.github.io/yanirseroussi.com/recommender-universe.jpg"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2015-10-02T05:25:57+00:00">
<meta property="article:modified_time" content="2015-10-02T05:25:57+00:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://yanirs.github.io/yanirseroussi.com/recommender-universe.jpg">
<meta name=twitter:title content="The wonderful world of recommender systems">
<meta name=twitter:description content="I recently gave a talk about recommender systems at the Data Science Sydney meetup (the slides are available here). This post roughly follows the outline of the talk, expanding on some of the key points in non-slide form (i.e., complete sentences and paragraphs!). The first few sections give a broad overview of the field and the common recommendation paradigms, while the final part is dedicated to debunking five common myths about recommender systems.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://yanirs.github.io/yanirseroussi.com/posts/"},{"@type":"ListItem","position":2,"name":"The wonderful world of recommender systems","item":"https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"The wonderful world of recommender systems","name":"The wonderful world of recommender systems","description":"I recently gave a talk about recommender systems at the Data Science Sydney meetup (the slides are available here). This post roughly follows the outline of the talk, expanding on some of the key points in non-slide form (i.e., complete sentences and paragraphs!). The first few sections give a broad overview of the field and the common recommendation paradigms, while the final part is dedicated to debunking five common myths about recommender systems.","keywords":["data science","machine learning","predictive modelling","recommender systems","software engineering"],"articleBody":"I recently gave a talk about recommender systems at the Data Science Sydney meetup (the slides are available here). This post roughly follows the outline of the talk, expanding on some of the key points in non-slide form (i.e., complete sentences and paragraphs!). The first few sections give a broad overview of the field and the common recommendation paradigms, while the final part is dedicated to debunking five common myths about recommender systems.\nMotivation: Why should we care about recommender systems? The key reason why many people seem to care about recommender systems is money. For companies such as Amazon, Netflix, and Spotify, recommender systems drive significant engagement and revenue. But this is the more cynical view of things. The reason these companies (and others) see increased revenue is because they deliver actual value to their customers – recommender systems provide a scalable way of personalising content for users in scenarios with many items.\nAnother reason why data scientists specifically should care about recommender systems is that it is a true data science problem. That is, at least according to my favourite definition of data science as the intersection between software engineering, machine learning, and statistics. As we will see, building successful recommender systems requires all of these skills (and more).\nDefining recommender systems When trying to the define anything, a reasonable first step is to ask Wikipedia. Unfortunately, as of the day of this post’s publication, Wikipedia defines recommender systems too narrowly, as “a subclass of information filtering system that seek to predict the ‘rating' or ‘preference' that a user would give to an item” (I should probably fix it, but this wrong definition helped my talk flow better – let me know if you fix it and I’ll update this paragraph).\nThe problem with Wikipedia’s definition is that there’s so much more to recommender systems than rating prediction. First, recommender is a misnomer – calling it a discovery assistant is better, as the so-called recommendations are far from binding. Second, system means that elements like presentation are important, which is part of what makes recommendation such an interesting data science problem.\nMy definition is simply:\nRecommender systems are systems that help users discover items they may like. Recommendation paradigms Depending on who you ask, there are between two and twenty different recommendation paradigms. The usual classification is by the type of data that is used to generate recommendations. The distinction between approaches is more academic than practical, as it is often a good idea to use hybrids/ensembles to address each method’s limitations. Nonetheless, it is worthwhile discussing the different paradigms. The way I see it, if you ignore trivial approaches that often work surprisingly well (e.g., popular items, and “watch it again”), there are four main paradigms: collaborative filtering, content-based, social/demographic, and contextual recommendation.\nCollaborative filtering is perhaps the most famous approach to recommendation, to the point that it is sometimes seen as synonymous with the field. The main idea is that you’re given a matrix of preferences by users for items, and these are used to predict missing preferences and recommend items with high predictions. One of the key advantages of this approach is that there has been a huge amount of research into collaborative filtering, making it pretty well-understood, with existing libraries that make implementation fairly straightforward. Another important advantage is that collaborative filtering is independent of item properties. All you need to get started is user and item IDs, and some notion of preference by users for items (ratings, views, etc.).\nThe major limitation of collaborative filtering is its reliance on preferences. In a cold-start scenario, where there are no preferences at all, it can’t generate any recommendations. However, cold starts can also occur when there are millions of available preferences, because pure collaborative recommendation doesn’t work for items or users with no ratings, and often performs pretty poorly when there are only a few ratings. Further, the underlying collaborative model may yield disappointing results when the preference matrix is sparse. In fact, this has been my experience in nearly every situation where I deployed collaborative filtering. It always requires tweaking, and never simply works out of the box.\nContent-based algorithms are given user preferences for items, and recommend similar items based on a domain-specific notion of item content. The main advantage of content-based recommendation over collaborative filtering is that it doesn’t require as much user feedback to get going. Even one known user preference can yield many good recommendations (which can lead to the collection of preferences to enable collaborative recommendation). In many scenarios, content-based recommendation is the most natural approach. For example, when recommending news articles or blog posts, it’s natural to compare the textual content of the items. This approach also extends naturally to cases where item metadata is available (e.g., movie stars, book authors, and music genres).\nOne problem with deploying content-based recommendations arises when item similarity is not so easily defined. However, even when it is natural to measure similarity, content-based recommendations may end up being too homogeneous to be useful. Such recommendations may also be too static over time, thereby failing to adjust to changes in individual user tastes and other shifts in the underlying data.\nSocial and demographic recommenders suggest items that are liked by friends, friends of friends, and demographically-similar people. Such recommenders don’t need any preferences by the user to whom recommendations are made, making them very powerful. In my experience, even trivially-implemented approaches can be depressingly accurate. For example, just summing the number of Facebook likes by a person’s close friends can often be enough to paint a pretty accurate picture of what that person likes.\nGiven this power of social and demographic recommenders, it isn’t surprising that social networks don’t easily give their data away. This means that for many practitioners, employing social/demographic recommendation algorithms is simply impossible. However, even when such data is available, it is not always easy to use without creeping users out. Further, privacy concerns need to be carefully addressed to ensure that users are comfortable with using the system.\nContextual recommendation algorithms recommend items that match the user’s current context. This allows them to be more flexible and adaptive to current user needs than methods that ignore context (essentially giving the same weight to all of the user’s history). Hence, contextual algorithms are more likely to elicit a response than approaches that are based only on historical data.\nThe key limitations of contextual recommenders are similar to those of social and demographic recommenders – contextual data may not always be available, and there’s a risk of creeping out the user. For example, ad retargeting can be seen as a form of contextual recommendation that follows users around the web and across devices, without having the explicit consent of the users to being tracked in this manner.\nFive common myths about recommender systems There are some common myths and misconceptions surrounding recommender systems. I’ve picked five to address in this post. If you disagree, agree, or have more to add, I would love to hear from you either privately or in the comment section.\nThe accuracy myth\nOffline optimisation of an accuracy measure is sufficient for creating a successful recommender\nReality\nUsers don't really care about accuracy This is perhaps the most prevalent myth of all, as evidenced by Wikipedia’s definition of recommender systems. It’s somewhat surprising that it still persists, as it’s been almost ten years since McNee et al.’s influential paper on the damage the focus on accuracy measures has done to the field.\nIt is therefore worth asking where this myth came from. My theory is that it is a feedback loop between academia and industry. In academia it is pretty easy to publish papers with infinitesimal improvements to arbitrary accuracy measures on offline datasets (I’m also guilty of doing just that), while it’s relatively hard to run experiments on live systems. However, one of the moves that significantly increased focus on offline predictive accuracy came from industry, in the form of the $1M Netflix prize, where the goal was to improve the accuracy of Netflix’s rating prediction algorithm by 10%.\nNotably, most of the algorithms that came out of the three-year competition were never integrated into Netflix. As discussed on the Netflix blog:\n You might be wondering what happened with the final Grand Prize ensemble that won the $1M two years later… We evaluated some of the new methods offline but the additional accuracy gains that we measured did not seem to justify the engineering effort needed to bring them into a production environment.\nOur business objective is to maximize member satisfaction and month-to-month subscription retention… Now it is clear that the Netflix Prize objective, accurate prediction of a movie’s rating, is just one of the many components of an effective recommendation system that optimizes our members' enjoyment.\n The following chart says it all (taken from the second part of the blog post quoted above):\n   An important question that arises is: If users don’t really care about predictive accuracy, what do they care about? The answer is that predictive accuracy has some importance (as evidenced by the above chart), but it is not the only thing. In my opinion, the key consideration is UI/UX. You can have the most accurate recommendations in the world, but no one would know about it (or care) if they are not served in a timely manner through a friendly interface.\nOf course, even with a great user interface and accurate predictions, there are other issues that require attention when designing recommender systems. Examples include diversity (showing various types of items), serendipity/novelty (showing non-obvious recommendations that users don’t already know about), and coverage (being able to generate recommendations for all users and items). Many other considerations are covered in an excellent survey by Guy Shani and Asela Gunawardana.\nIt’s also worth noting that there is an inherent problem with common accuracy measures. Specifically, when using a measure like root mean square error, a rating prediction algorithm can be made to perform better by reducing errors on low ratings. This is rather pointless, because items with low ratings will not be shown to users in any case.\nFinally, a key issue that arises with offline evaluation is that there are biases in offline datasets that do not necessarily carry over to online scenarios. For instance, in many cases there is an implicit assumption that data is missing at random, when it really isn’t, e.g., the fact that users took the effort to watch and rate a movie already tells us a lot about a bias they have towards this movie (the team that won the Netflix prize used this bias to their advantage). Hiding this rating and trying to predict it is not the same as predicting a rating for a movie that is picked at random from the entire set of movies.\nThe black box myth\nYou can build successful recommender systems without worrying about what's being recommended and how recommendations are being served\nReality\nUI/UX is king, item type is critical A good recommender system has to consider how users interact with the recommendations. For example, the number of displayed recommendations should inform the optimisation procedure (e.g., are you aiming for precision@1 or precision@10?). How these recommendations are laid out (e.g., horizontally/vertically) tends to influence user interaction. In addition, being able to explain the reasons for the recommendations can yield easy wins. Finally, in many cases there are constraints on the amount of time that can be spent generating recommendations.\nIn addition to UI/UX, the design of good recommender systems has to account for what’s being recommended. For example, music tracks and short videos can be played many times, so it’s probably a good idea to recommend items that the user has already seen. On the other hand, items like washing machines and cars don’t get consumed as often. If a user has just bought a washing machine, they’re unlikely to want another one anytime soon (but they may want a dryer or a clothes line).\n   Hynt is a recommender-system-as-a-service for e-commerce whose development I led up until the middle of last year. The general idea is that merchants simply add a few lines of JavaScript to their shop pages and Hynt does the hard work of recommending relevant items from the store, while considering the user and page context. Going live with Hynt reaffirmed many well-known UI/UX lessons. Most notably:\n Above the fold is better than below. Engagement with Hynt widgets that were visible without scrolling was higher than those that were lower on the page. More recommendations are better than a few. Hynt widgets are responsive, adapting to the size of the container they’re placed in. Engagement was more likely when more recommendations were displayed, because users were more likely to find something they liked without scrolling through the widget. Fast is better than slow. If recommendations load faster, more people see them, which increases engagement. In Hynt’s case speed was especially important because the widgets load asynchronously after the host page finishes loading.  Another important UI/UX element is explanations. Displaying a plausible explanation next to a recommendation can do wonders, without making any changes to the underlying recommendation algorithms. The impact of explanations has been studied extensively by Nava Tintarev and Judith Masthoff. They have identified seven different aims of explanations, which are summarised in the following table (reproduced from their survey of explanations in recommender systems).\n   Aim Definition     Transparency Explain how the system works   Scrutability Allow users to tell the system it is wrong   Trust Increase user confidence in the system   Effectiveness Help users make good decisions   Persuasiveness Convince users to try or buy   Efficiency Help users make decisions faster   Satisfaction Increase ease of usability or enjoyment    Explanations are ubiquitous in real-world recommender systems. For example, Amazon uses explanations like “frequently bought together”, and “customers who bought this item also bought”, while Netflix presents different lists of recommendations where each list is driven by a different reason. However, as the following Netflix example shows, it is worth making sure that the explanations you provide don’t make you look stupid.\n      The solved problem myth\nThe space of recommender systems has been exhaustively explored\nReality\nDevelopment of new methods is often required When I finished my PhD, about three years ago, I joined a small startup called Giveable as the first employee (essentially part of the founding team that was formed after Adam Neumann, the original founder, graduated from AngelCube and raised some seed funding). Giveable’s original product was a webapp where users could connect with their Facebook account and find gifts for their friends.\n   At the time, there wasn’t much published research on gift recommendation, and there was more or less nothing about the specific problem of recommending gifts for Facebook friends using liked pages. Here are some of the ways this problem differs from classic recommendation scenarios.\n Need to consider giver and receiver. Unlike traditional scenarios, the recommended items aren’t consumed by the user to whom they’re shown. In practice, this meant that we had to ensure the items are giftable, and take into account the relationship between the giver and the receiver. For example, the type of gift your mum may give you is different from gifts your partner may give you. Likes are historical, sparse, and often nonsensical. This is best illustrated by an example: What does liking a page such as Tony Abbott – Worst PM in Australian History tell us about gifts the user may like? Tony Abbott is no longer prime minister (thankfully), so it’s historical, and while this page is quite popular, there are many other pages out there that are difficult to interpret and are liked by only a handful of people (this video is a good summary of why Tony is disliked, for those who are unfamiliar with Australian politics). Likes are not for recommended items. As the above example shows, just because you like disliking Tony, it doesn’t exactly lead to useful gifts. Even with things that are more related to interests, such as authors and bands, the liked pages aren’t recommendable as gifts. Likes are not always available offline. This was an important engineering consideration: We didn’t have much time to generate recommendations from the point where a new user gave us permission to view their likes and the likes of their friends. Ideally, recommendation generation would take less than a second from the time we got all the data from Facebook. This puts a strong constraint on the types of algorithms we could use.  The key to effectively addressing the Giveable recommendation problem was doing as much processing offline as possible. Specifically:\n Similar pages were inferred using Latent Dirichlet Allocation (which can be seen as a collaborative filtering technique). This made it possible to use information from pages that are not directly linked to giftable products, e.g., for the above Tony Abbott example, people who dislike him are likely to be left-leaning, which implies many other interests. Facebook pages were matched to giftable products with heuristics + Mechanical Turk + machine learning. This took a few iterations of what was essentially partly-manual semi-supervised learning, where we obtained high-confidence matches through heuristics and manual tagging, and then used this to train a classifier that was used to classify uncertain matches. The results of classification on a hold-out set were then verified through manual tagging of subsamples. We enriched the page and product data with structured information from the Freebase knowledge graph (which has since been deprecated). This allowed us to easily match giftable products to liked pages, e.g., books to authors.  The online part included taking a receiver’s liked pages, inferring likes for similar pages, and matching all these pages to a ranked and diversified list of giftable product recommendations. These recommendations came with explanations, which were quite important in this case because the giver of a gift has to know why they’re giving it.\nThe silver bullet myth\nOptimising a single measure or using a single algorithm is sufficient for generating a good recommendation list\nReality\nHybrids work best Netflix provides another example for how focusing on a single algorithm or measure of success is far from sufficient. In a recent blog post, they talk about how they use multiple algorithms to optimise the order of different recommendation lists and each list’s internal ranking, while considering device-specific UI constraints, relevance, engagement, diversity, business requirements, and more.\nAn example from my experience comes from Giveable (which ended up evolving into Hynt), where a single list was generated by mixing the outputs of the following recommendation approaches: contextual, direct likes, inferred likes, content-based, social, collaborative filtering of products, previously viewed items, and popular interests/products. The weight of each algorithm in the mix was static – it was either set manually or through A/B testing, and then left as a hardcoded constant.\nThis kind of static mix can get you very far, but there’s a better way that I haven’t gotten around to implementing before leaving to work on other things. This way is described in a series of posts on bandits for recommenders by Sergey Feldman of RichRelevance. The general idea is to train recommendation models offline using a small number of strategies/paradigms. Online, recommendations are served from strategies that maximise clickthrough and revenue, given a context of features that describe the user, merchant, and web page where the RichRelevance widget is embedded. Rather than setting static weights for the strategies, the bandit model continuously adjusts the weights, while balancing between exploring new strategy weights and exploiting strategies that have been known to work well in a specific context. This allows the overall recommendation engine to adjust to changes in reality and in the underlying data.\nThe omnipresence myth\nEvery personalised system is a recommender system\nReality\nThis one is kinda true, but not necessarily useful... The first conference I attended as a PhD student was the 18th International Conference on User Modeling, Adaptation and Personalization (UMAP), back in 2010. The field of recommender systems was getting increased attention, and Peter Brusilovsky, who has been working in the UMAP field for decades, argued that recommender systems are the new expert systems. This was partly because the hype was causing people to broaden the definition of the field to allow them to say that they’re working on recommender systems.\nI don’t think it’s incorrect that personalisation and recommender systems are different things. However, one problem that this may cause is making people think that common recommendation techniques would apply in scenarios where they’re unlikely to work. For example, web search can be seen as a recommender system for pages that gives a high weight to the user’s intent, as captured by the query. Hence, when personalising web search, it seems sensible to use collaborative filtering techniques. This was indeed my experience with the Yandex search personalisation competition: employing a matrix factorisation approach that was inspired by collaborative filtering turned out to be a waste of time compared to domain-specific methods.\nIn conclusion, recommenders are about as murky as data science. Just like data science, the boundaries of recommender systems are hard to define and they are sometimes over-hyped. This hype may lead to people investing in a recommender system they don’t really need, just like the common issue of premature investment in data science. However, the hype is based on real value, which can definitely be delivered by recommender systems when they are used correctly.\n","wordCount":"3577","inLanguage":"en","image":"https://yanirs.github.io/yanirseroussi.com/recommender-universe.jpg","datePublished":"2015-10-02T05:25:57Z","dateModified":"2015-10-02T05:25:57Z","author":{"@type":"Person","name":"Yanir Seroussi"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/"},"publisher":{"@type":"Organization","name":"Yanir Seroussi | Data science and beyond","logo":{"@type":"ImageObject","url":"https://yanirs.github.io/yanirseroussi.com/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://yanirs.github.io/yanirseroussi.com/ accesskey=h title="Yanir Seroussi | Data science and beyond (Alt + H)">Yanir Seroussi | Data science and beyond</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
The wonderful world of recommender systems
</h1>
<div class=post-meta>October 2, 2015&nbsp;·&nbsp;Yanir Seroussi&nbsp;|&nbsp;<a href=https://github.com/yanirs/yanirseroussi.com/blob/master/content/posts/2015-10-02-the-wonderful-world-of-recommender-systems/index.md rel="noopener noreferrer" target=_blank>Suggest changes</a>
</div>
</header>
<figure class=entry-cover>
<img loading=lazy srcset="https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/recommender-universe_hu04af572edec61288f5f08ad15b2b373c_1725198_360x0_resize_q75_box.jpg 360w ,https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/recommender-universe_hu04af572edec61288f5f08ad15b2b373c_1725198_480x0_resize_q75_box.jpg 480w ,https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/recommender-universe_hu04af572edec61288f5f08ad15b2b373c_1725198_720x0_resize_q75_box.jpg 720w ,https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/recommender-universe_hu04af572edec61288f5f08ad15b2b373c_1725198_1080x0_resize_q75_box.jpg 1080w ,https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/recommender-universe_hu04af572edec61288f5f08ad15b2b373c_1725198_1500x0_resize_q75_box.jpg 1500w ,https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/recommender-universe.jpg 4961w" sizes="(min-width: 768px) 720px, 100vw" src=https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/recommender-universe.jpg alt width=4961 height=2468>
</figure>
<div class=post-content><p>I recently gave a talk about recommender systems at the <a href=http://www.meetup.com/Data-Science-Sydney/ target=_blank rel=noopener>Data Science Sydney meetup</a> (the slides are available <a href=http://yanirs.github.io/talks/the-wonderful-world-of-recommender-systems target=_blank rel=noopener>here</a>). This post roughly follows the outline of the talk, expanding on some of the key points in non-slide form (i.e., complete sentences and paragraphs!). The first few sections give a broad overview of the field and the common recommendation paradigms, while the final part is dedicated to debunking five common myths about recommender systems.</p>
<h3 id=motivation-why-should-we-care-about-recommender-systems>Motivation: Why should we care about recommender systems?<a hidden class=anchor aria-hidden=true href=#motivation-why-should-we-care-about-recommender-systems>#</a></h3>
<p>The key reason why many people seem to care about recommender systems is <em>money</em>. For companies such as Amazon, Netflix, and Spotify, recommender systems drive significant engagement and revenue. But this is the more cynical view of things. The reason these companies (and others) see increased revenue is because they deliver actual <em>value</em> to their customers – recommender systems provide a scalable way of personalising content for users in scenarios with many items.</p>
<p>Another reason why data scientists specifically should care about recommender systems is that it is a true data science problem. That is, at least according to <a href=http://yanirseroussi.com/2014/10/23/what-is-data-science/>my favourite definition of data science</a> as the intersection between software engineering, machine learning, and statistics. As we will see, building successful recommender systems requires all of these skills (and more).</p>
<h3 id=defining-recommender-systems>Defining recommender systems<a hidden class=anchor aria-hidden=true href=#defining-recommender-systems>#</a></h3>
<p>When trying to the define anything, a reasonable first step is to ask Wikipedia. Unfortunately, as of the day of this post&rsquo;s publication, <a href=http://en.wikipedia.org/wiki/Recommender_system target=_blank rel=noopener>Wikipedia defines recommender systems too narrowly</a>, as &ldquo;a subclass of information filtering system that seek to predict the ‘rating' or ‘preference' that a user would give to an item&rdquo; (I should probably fix it, but this wrong definition helped my talk flow better – let me know if you fix it and I&rsquo;ll update this paragraph).</p>
<p>The problem with Wikipedia&rsquo;s definition is that there&rsquo;s so much more to recommender systems than rating prediction. First, <em>recommender</em> is a misnomer – calling it a discovery assistant is better, as the so-called recommendations are far from binding. Second, <em>system</em> means that elements like presentation are important, which is part of what makes recommendation such an interesting data science problem.</p>
<p>My definition is simply:</p>
<p class=highlight-box>
<i>Recommender systems are systems that help users discover items they may like.</i>
</p>
<h3 id=recommendation-paradigms>Recommendation paradigms<a hidden class=anchor aria-hidden=true href=#recommendation-paradigms>#</a></h3>
<p>Depending on who you ask, there are between two and twenty different recommendation paradigms. The usual classification is by the type of data that is used to generate recommendations. The distinction between approaches is more academic than practical, as it is often a good idea to use hybrids/ensembles to address each method&rsquo;s limitations. Nonetheless, it is worthwhile discussing the different paradigms. The way I see it, if you ignore trivial approaches that often work surprisingly well (e.g., popular items, and &ldquo;watch it again&rdquo;), there are four main paradigms: collaborative filtering, content-based, social/demographic, and contextual recommendation.</p>
<p><strong>Collaborative filtering</strong> is perhaps the most famous approach to recommendation, to the point that it is sometimes seen as synonymous with the field. The main idea is that you&rsquo;re given a matrix of preferences by users for items, and these are used to predict missing preferences and recommend items with high predictions. One of the key advantages of this approach is that there has been a huge amount of research into collaborative filtering, making it pretty well-understood, with existing libraries that make implementation fairly straightforward. Another important advantage is that collaborative filtering is independent of item properties. All you need to get started is user and item IDs, and some notion of preference by users for items (ratings, views, etc.).</p>
<p>The major limitation of collaborative filtering is its reliance on preferences. In a cold-start scenario, where there are no preferences at all, it can&rsquo;t generate any recommendations. However, cold starts can also occur when there are millions of available preferences, because pure collaborative recommendation doesn&rsquo;t work for items or users with no ratings, and <a href=https://dl.dropboxusercontent.com/u/25632965/SeroussiBohnertZukerman2011.pdf target=_blank rel=noopener>often performs pretty poorly when there are only a few ratings</a>. Further, the underlying collaborative model may yield disappointing results when the preference matrix is sparse. In fact, this has been my experience in <a href=http://yanirseroussi.com/2014/09/19/bandcamp-recommendation-and-discovery-algorithms/>nearly every situation where I deployed collaborative filtering</a>. It always requires tweaking, and never simply works out of the box.</p>
<p><strong>Content-based</strong> algorithms are given user preferences for items, and recommend similar items based on a domain-specific notion of item content. The main advantage of content-based recommendation over collaborative filtering is that it doesn&rsquo;t require as much user feedback to get going. Even one known user preference can yield many good recommendations (which can lead to the collection of preferences to enable collaborative recommendation). In many scenarios, content-based recommendation is the most natural approach. For example, when recommending news articles or blog posts, it&rsquo;s natural to compare the textual content of the items. This approach also extends naturally to cases where item metadata is available (e.g., movie stars, book authors, and music genres).</p>
<p>One problem with deploying content-based recommendations arises when item similarity is not so easily defined. However, even when it is natural to measure similarity, content-based recommendations may end up being too homogeneous to be useful. Such recommendations may also be too static over time, thereby failing to adjust to changes in individual user tastes and other shifts in the underlying data.</p>
<p><strong>Social and demographic</strong> recommenders suggest items that are liked by friends, friends of friends, and demographically-similar people. Such recommenders don&rsquo;t need any preferences by the user to whom recommendations are made, making them very powerful. In my experience, even trivially-implemented approaches can be depressingly accurate. For example, just summing the number of Facebook likes by a person&rsquo;s close friends can often be enough to paint a pretty accurate picture of what that person likes.</p>
<p>Given this power of social and demographic recommenders, it isn&rsquo;t surprising that social networks don&rsquo;t easily give their data away. This means that for many practitioners, employing social/demographic recommendation algorithms is simply impossible. However, even when such data is available, it is not always easy to use without creeping users out. Further, privacy concerns need to be carefully addressed to ensure that users are comfortable with using the system.</p>
<p><strong>Contextual</strong> recommendation algorithms recommend items that match the user&rsquo;s current context. This allows them to be more flexible and adaptive to current user needs than methods that ignore context (essentially giving the same weight to all of the user&rsquo;s history). Hence, contextual algorithms are more likely to elicit a response than approaches that are based only on historical data.</p>
<p>The key limitations of contextual recommenders are similar to those of social and demographic recommenders – contextual data may not always be available, and there&rsquo;s a risk of creeping out the user. For example, <a href=https://en.wikipedia.org/wiki/Behavioral_retargeting target=_blank rel=noopener>ad retargeting</a> can be seen as a form of contextual recommendation that follows users around the web and across devices, without having the explicit consent of the users to being tracked in this manner.</p>
<h3 id=five-common-myths-about-recommender-systems>Five common myths about recommender systems<a hidden class=anchor aria-hidden=true href=#five-common-myths-about-recommender-systems>#</a></h3>
<p>There are some common myths and misconceptions surrounding recommender systems. I&rsquo;ve picked five to address in this post. If you disagree, agree, or have more to add, I would love to hear from you either <a href=http://yanirseroussi.com/about/>privately</a> or in the comment section.</p>
<p class=highlight-box>
<b>The accuracy myth</b><br> Offline optimisation of an accuracy measure is sufficient for creating a successful recommender<br> <b>Reality</b><br> Users don't really care about accuracy
</p>
<p>This is perhaps the most prevalent myth of all, as evidenced by Wikipedia&rsquo;s definition of recommender systems. It&rsquo;s somewhat surprising that it still persists, as it&rsquo;s been almost ten years since <a href="http://dl.acm.org/citation.cfm?id=1125659" target=_blank rel=noopener>McNee et al.&rsquo;s influential paper on the damage the focus on accuracy measures has done to the field</a>.</p>
<p>It is therefore worth asking where this myth came from. My theory is that it is a feedback loop between academia and industry. In academia it is pretty easy to publish papers with infinitesimal improvements to arbitrary accuracy measures on offline datasets (<a href=https://dl.dropboxusercontent.com/u/25632965/SeroussiBohnertZukerman2011.pdf target=_blank rel=noopener>I&rsquo;m also guilty of doing just that</a>), while it&rsquo;s relatively hard to run experiments on live systems. However, one of the moves that significantly increased focus on offline predictive accuracy came from industry, in the form of the <a href=https://en.wikipedia.org/wiki/Netflix_Prize target=_blank rel=noopener>$1M Netflix prize</a>, where the goal was to improve the accuracy of Netflix&rsquo;s rating prediction algorithm by 10%.</p>
<p>Notably, most of the algorithms that came out of the three-year competition were never integrated into Netflix. As <a href=http://techblog.netflix.com/2012/04/netflix-recommendations-beyond-5-stars.html target=_blank rel=noopener>discussed on the Netflix blog</a>:</p>
<blockquote>
<p>You might be wondering what happened with the final Grand Prize ensemble that won the $1M two years later&mldr; We evaluated some of the new methods offline but the additional accuracy gains that we measured did not seem to justify the engineering effort needed to bring them into a production environment.</p>
<p>Our business objective is to maximize member satisfaction and month-to-month subscription retention&mldr; Now it is clear that the Netflix Prize objective, accurate prediction of a movie&rsquo;s rating, is just one of the many components of an effective recommendation system that optimizes our members' enjoyment.</p>
</blockquote>
<p>The following chart says it all (taken from <a href=http://techblog.netflix.com/2012/06/netflix-recommendations-beyond-5-stars.html target=_blank rel=noopener>the second part of the blog post quoted above</a>):</p>
<figure>
<a href=netflix-rating-prediction-contribution.png target=_blank rel=noopener>
<img sizes="
          (min-width: 768px) 720px,
          100vw
        " srcset="https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/netflix-rating-prediction-contribution_hu4d59641bac20d42b471a6b4658d17e86_9091_360x0_resize_box_3.png 360w,
https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/netflix-rating-prediction-contribution_hu4d59641bac20d42b471a6b4658d17e86_9091_480x0_resize_box_3.png 480w,
https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/netflix-rating-prediction-contribution_hu4d59641bac20d42b471a6b4658d17e86_9091_720x0_resize_box_3.png 720w,
https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/netflix-rating-prediction-contribution.png 908w," src=https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/netflix-rating-prediction-contribution_hu4d59641bac20d42b471a6b4658d17e86_9091_800x0_resize_box_3.png alt="Netflix rating prediction: contribution of ratings" loading=lazy>
</a>
</figure>
<p>An important question that arises is: If users don&rsquo;t really care about predictive accuracy, what do they care about? The answer is that predictive accuracy has some importance (as evidenced by the above chart), but it is not the only thing. In my opinion, the key consideration is UI/UX. You can have the most accurate recommendations in the world, but no one would know about it (or care) if they are not served in a timely manner through a friendly interface.</p>
<p>Of course, even with a great user interface and accurate predictions, there are other issues that require attention when designing recommender systems. Examples include diversity (showing various types of items), serendipity/novelty (showing non-obvious recommendations that users don&rsquo;t already know about), and coverage (being able to generate recommendations for all users and items). Many other considerations are covered in <a href=http://www.bgu.ac.il/~shanigu/Publications/EvaluationMetrics.17.pdf target=_blank rel=noopener>an excellent survey by Guy Shani and Asela Gunawardana</a>.</p>
<p>It&rsquo;s also worth noting that there is an inherent problem with common accuracy measures. Specifically, when using a measure like root mean square error, a rating prediction algorithm can be made to perform better by reducing errors on low ratings. This is rather pointless, because items with low ratings will not be shown to users in any case.</p>
<p>Finally, a key issue that arises with offline evaluation is that there are biases in offline datasets that do not necessarily carry over to online scenarios. For instance, in many cases there is an implicit assumption that <a href=http://users.cs.fiu.edu/~lzhen001/activities/KDD_USB_key_2010/docs/p713.pdf target=_blank rel=noopener>data is missing at random</a>, when it really isn&rsquo;t, e.g., the fact that users took the effort to watch and rate a movie already tells us a lot about a bias they have towards this movie (the team that won the Netflix prize used this bias to their advantage). Hiding this rating and trying to predict it is not the same as predicting a rating for a movie that is picked at random from the entire set of movies.</p>
<p class=highlight-box>
<b>The black box myth</b><br> You can build successful recommender systems without worrying about what's being recommended and how recommendations are being served<br> <b>Reality</b><br> UI/UX is king, item type is critical
</p>
<p>A good recommender <em>system</em> has to consider how users interact with the recommendations. For example, the number of displayed recommendations should inform the optimisation procedure (e.g., are you aiming for <a href=https://en.wikipedia.org/wiki/Precision_and_recall#Precision target=_blank rel=noopener>precision@1 or precision@10</a>?). How these recommendations are laid out (e.g., horizontally/vertically) tends to influence user interaction. In addition, being able to explain the reasons for the recommendations can yield easy wins. Finally, in many cases there are constraints on the amount of time that can be spent generating recommendations.</p>
<p>In addition to UI/UX, the design of good recommender <em>systems</em> has to account for what&rsquo;s being recommended. For example, music tracks and short videos can be played many times, so it&rsquo;s probably a good idea to recommend items that the user has already seen. On the other hand, items like washing machines and cars don&rsquo;t get consumed as often. If a user has just bought a washing machine, they&rsquo;re unlikely to want another one anytime soon (but they may want a dryer or a clothes line).</p>
<figure>
<a href=hynt-screenshot.png target=_blank rel=noopener>
<img sizes="
          (min-width: 768px) 720px,
          100vw
        " srcset="https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/hynt-screenshot_hu0fec6f9c1423d881327516504f7d951f_141185_360x0_resize_box_3.png 360w,
https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/hynt-screenshot_hu0fec6f9c1423d881327516504f7d951f_141185_480x0_resize_box_3.png 480w,
https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/hynt-screenshot_hu0fec6f9c1423d881327516504f7d951f_141185_720x0_resize_box_3.png 720w,
https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/hynt-screenshot.png 750w," src=https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/hynt-screenshot.png alt="Hynt recommendation widget" loading=lazy>
</a>
</figure>
<p><a href=https://hynt.com target=_blank rel=noopener>Hynt</a> is a recommender-system-as-a-service for e-commerce whose development I led up until the middle of last year. The general idea is that merchants simply add a few lines of JavaScript to their shop pages and Hynt does the hard work of recommending relevant items from the store, while considering the user and page context. Going live with Hynt reaffirmed many well-known UI/UX lessons. Most notably:</p>
<ul>
<li><em>Above the fold is better than below.</em> Engagement with Hynt widgets that were visible without scrolling was higher than those that were lower on the page.</li>
<li><em>More recommendations are better than a few.</em> Hynt widgets are responsive, adapting to the size of the container they&rsquo;re placed in. Engagement was more likely when more recommendations were displayed, because users were more likely to find something they liked without scrolling through the widget.</li>
<li><em>Fast is better than slow.</em> If recommendations load faster, more people see them, which increases engagement. In Hynt&rsquo;s case speed was especially important because the widgets load asynchronously after the host page finishes loading.</li>
</ul>
<p>Another important UI/UX element is explanations. Displaying a plausible explanation next to a recommendation can do wonders, without making any changes to the underlying recommendation algorithms. The impact of explanations has been studied extensively by Nava Tintarev and Judith Masthoff. They have identified seven different aims of explanations, which are summarised in the following table (reproduced from their <a href=http://homepages.abdn.ac.uk/n.tintarev/pages/papers/TintarevMasthoffICDE07.pdf target=_blank rel=noopener>survey of explanations in recommender systems</a>).</p>
<table>
<thead>
<tr>
<th>Aim</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>Transparency</td>
<td>Explain how the system works</td>
</tr>
<tr>
<td>Scrutability</td>
<td>Allow users to tell the system it is wrong</td>
</tr>
<tr>
<td>Trust</td>
<td>Increase user confidence in the system</td>
</tr>
<tr>
<td>Effectiveness</td>
<td>Help users make good decisions</td>
</tr>
<tr>
<td>Persuasiveness</td>
<td>Convince users to try or buy</td>
</tr>
<tr>
<td>Efficiency</td>
<td>Help users make decisions faster</td>
</tr>
<tr>
<td>Satisfaction</td>
<td>Increase ease of usability or enjoyment</td>
</tr>
</tbody>
</table>
<p>Explanations are ubiquitous in real-world recommender systems. For example, Amazon uses explanations like &ldquo;frequently bought together&rdquo;, and &ldquo;customers who bought this item also bought&rdquo;, while Netflix presents different lists of recommendations where each list is driven by a different reason. However, as the following Netflix example shows, it is worth making sure that the explanations you provide don&rsquo;t <a href=http://funnyjunk.com/Thanks+netflix/funny-pictures/5040772/ target=_blank rel=noopener>make you look stupid</a>.</p>
<figure>
<a href=amazon-frequently-bought-together.png target=_blank rel=noopener>
<img sizes="
          (min-width: 768px) 633px,
          100vw
        " srcset="https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/amazon-frequently-bought-together_huc704a97f1a57172d448482424c4950ae_59366_360x0_resize_box_3.png 360w,
https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/amazon-frequently-bought-together_huc704a97f1a57172d448482424c4950ae_59366_480x0_resize_box_3.png 480w,
https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/amazon-frequently-bought-together.png 633w," src=https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/amazon-frequently-bought-together.png alt="Amazon frequently bought together" loading=lazy>
</a>
</figure>
<figure>
<a href=netflix-because-you-watched.png target=_blank rel=noopener>
<img sizes="
          (min-width: 768px) 720px,
          100vw
        " srcset="https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/netflix-because-you-watched_hude29a4b511130a36a03a429971137769_275713_360x0_resize_box_3.png 360w,
https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/netflix-because-you-watched_hude29a4b511130a36a03a429971137769_275713_480x0_resize_box_3.png 480w,
https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/netflix-because-you-watched_hude29a4b511130a36a03a429971137769_275713_720x0_resize_box_3.png 720w,
https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/netflix-because-you-watched.png 752w," src=https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/netflix-because-you-watched.png alt="Netflix because you watched" loading=lazy>
</a>
</figure>
<p class=highlight-box>
<b>The solved problem myth</b><br> The space of recommender systems has been exhaustively explored<br> <b>Reality</b><br> Development of new methods is often required
</p>
<p>When I finished <a href=http://yanirseroussi.com/phd-work/>my PhD</a>, about three years ago, I joined a small startup called Giveable as the first employee (essentially part of the founding team that was formed after Adam Neumann, the original founder, graduated from <a href=http://angelcube.com/ target=_blank rel=noopener>AngelCube</a> and raised some seed funding). Giveable&rsquo;s original product was a webapp where users could connect with their Facebook account and find gifts for their friends.</p>
<figure>
<a href=giveable-logo.png target=_blank rel=noopener>
<img sizes="
          (min-width: 768px) 250px,
          100vw
        " srcset="https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/giveable-logo.png 250w," src=https://yanirs.github.io/yanirseroussi.com/2015/10/02/the-wonderful-world-of-recommender-systems/giveable-logo.png alt="Giveable logo" loading=lazy>
</a>
</figure>
<p>At the time, there wasn&rsquo;t much published research on gift recommendation, and there was more or less nothing about the specific problem of recommending gifts for Facebook friends using liked pages. Here are some of the ways this problem differs from classic recommendation scenarios.</p>
<ul>
<li><em>Need to consider giver and receiver.</em> Unlike traditional scenarios, the recommended items aren&rsquo;t consumed by the user to whom they&rsquo;re shown. In practice, this meant that we had to ensure the items are <em>giftable</em>, and take into account the relationship between the giver and the receiver. For example, the type of gift your mum may give you is different from gifts your partner may give you.</li>
<li><em>Likes are historical, sparse, and often nonsensical.</em> This is best illustrated by an example: What does liking a page such as <a href=https://www.facebook.com/Tony-Abbott-Worst-PM-in-Australian-History-151576228341304 target=_blank rel=noopener>Tony Abbott – Worst PM in Australian History</a> tell us about gifts the user may like? Tony Abbott is no longer prime minister (thankfully), so it&rsquo;s historical, and while this page is quite popular, there are many other pages out there that are difficult to interpret and are liked by only a handful of people (<a href="https://www.youtube.com/watch?v=c3IaKVmkXuk" target=_blank rel=noopener>this video is a good summary of why Tony is disliked, for those who are unfamiliar with Australian politics</a>).</li>
<li><em>Likes are not for recommended items.</em> As the above example shows, just because you like disliking Tony, it doesn&rsquo;t exactly lead to useful gifts. Even with things that are more related to interests, such as authors and bands, the liked pages aren&rsquo;t recommendable as gifts.</li>
<li><em>Likes are not always available offline.</em> This was an important engineering consideration: We didn&rsquo;t have much time to generate recommendations from the point where a new user gave us permission to view their likes and the likes of their friends. Ideally, recommendation generation would take less than a second from the time we got all the data from Facebook. This puts a strong constraint on the types of algorithms we could use.</li>
</ul>
<p>The key to effectively addressing the Giveable recommendation problem was doing as much processing offline as possible. Specifically:</p>
<ul>
<li>Similar pages were inferred using <a href=https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation target=_blank rel=noopener>Latent Dirichlet Allocation</a> (which can be seen as a collaborative filtering technique). This made it possible to use information from pages that are not directly linked to giftable products, e.g., for the above Tony Abbott example, people who dislike him are likely to be left-leaning, which implies many other interests.</li>
<li>Facebook pages were matched to giftable products with heuristics + <a href=https://www.mturk.com/ target=_blank rel=noopener>Mechanical Turk</a> + machine learning. This took a few iterations of what was essentially partly-manual <a href=https://en.wikipedia.org/wiki/Semi-supervised_learning target=_blank rel=noopener>semi-supervised learning</a>, where we obtained high-confidence matches through heuristics and manual tagging, and then used this to train a classifier that was used to classify uncertain matches. The results of classification on a hold-out set were then verified through manual tagging of subsamples.</li>
<li>We enriched the page and product data with structured information from the Freebase knowledge graph (<a href=https://plus.google.com/109936836907132434202/posts/3aYFVNf92A1 target=_blank rel=noopener>which has since been deprecated</a>). This allowed us to easily match giftable products to liked pages, e.g., books to authors.</li>
</ul>
<p>The online part included taking a receiver&rsquo;s liked pages, inferring likes for similar pages, and matching all these pages to a ranked and diversified list of giftable product recommendations. These recommendations came with explanations, which were quite important in this case because the giver of a gift has to know why they&rsquo;re giving it.</p>
<p class=highlight-box>
<b>The silver bullet myth</b><br> Optimising a single measure or using a single algorithm is sufficient for generating a good recommendation list<br> <b>Reality</b><br> Hybrids work best
</p>
<p>Netflix provides another example for how focusing on a single algorithm or measure of success is far from sufficient. In a <a href=http://techblog.netflix.com/2015/04/learning-personalized-homepage.html target=_blank rel=noopener>recent blog post</a>, they talk about how they use multiple algorithms to optimise the order of different recommendation lists and each list&rsquo;s internal ranking, while considering device-specific UI constraints, relevance, engagement, diversity, business requirements, and more.</p>
<p>An example from my experience comes from Giveable (which ended up evolving into Hynt), where a single list was generated by mixing the outputs of the following recommendation approaches: contextual, direct likes, inferred likes, content-based, social, collaborative filtering of products, previously viewed items, and popular interests/products. The weight of each algorithm in the mix was static – it was either set manually or through A/B testing, and then left as a hardcoded constant.</p>
<p>This kind of static mix can get you very far, but there&rsquo;s a better way that I haven&rsquo;t gotten around to implementing before leaving to work on other things. This way is described in <a href=http://engineering.richrelevance.com/bandits-recommendation-systems/ target=_blank rel=noopener>a series of posts on bandits for recommenders by Sergey Feldman of RichRelevance</a>. The general idea is to train recommendation models offline using a small number of strategies/paradigms. Online, recommendations are served from strategies that maximise clickthrough and revenue, given a context of features that describe the user, merchant, and web page where the RichRelevance widget is embedded. Rather than setting static weights for the strategies, the bandit model continuously adjusts the weights, while balancing between exploring new strategy weights and exploiting strategies that have been known to work well in a specific context. This allows the overall recommendation engine to adjust to changes in reality and in the underlying data.</p>
<p class=highlight-box>
<b>The omnipresence myth</b><br> Every personalised system is a recommender system<br> <b>Reality</b><br> This one is kinda true, but not necessarily useful...
</p>
<p>The first conference I attended as a PhD student was the 18th International Conference on User Modeling, Adaptation and Personalization (UMAP), back in 2010. The field of recommender systems was getting increased attention, and <a href=https://en.wikipedia.org/wiki/Peter_Brusilovsky target=_blank rel=noopener>Peter Brusilovsky</a>, who has been working in the UMAP field for decades, argued that recommender systems are the new <a href=https://en.wikipedia.org/wiki/Expert_system target=_blank rel=noopener>expert systems</a>. This was partly because the hype was causing people to broaden the definition of the field to allow them to say that they&rsquo;re working on recommender systems.</p>
<p>I don&rsquo;t think it&rsquo;s incorrect that personalisation and recommender systems are different things. However, one problem that this may cause is making people think that common recommendation techniques would apply in scenarios where they&rsquo;re unlikely to work. For example, web search can be seen as a recommender system for pages that gives a high weight to the user&rsquo;s intent, as captured by the query. Hence, when personalising web search, it seems sensible to use collaborative filtering techniques. This was indeed my experience with <a href=http://yanirseroussi.com/2015/02/11/learning-to-rank-for-personalised-search-yandex-search-personalisation-kaggle-competition-summary-part-2/>the Yandex search personalisation competition</a>: employing a matrix factorisation approach that was inspired by collaborative filtering turned out to be a waste of time compared to domain-specific methods.</p>
<p><strong>In conclusion</strong>, recommenders are about as murky as data science. Just like data science, the boundaries of recommender systems are hard to define and they are sometimes over-hyped. This hype may lead to people investing in a recommender system they don&rsquo;t really need, just like <a href=http://yanirseroussi.com/2015/08/24/you-dont-need-a-data-scientist-yet/>the common issue of premature investment in data science</a>. However, the hype is based on real value, which can definitely be delivered by recommender systems when they are used correctly.</p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://yanirs.github.io/yanirseroussi.com/tags/data-science/>data science</a></li>
<li><a href=https://yanirs.github.io/yanirseroussi.com/tags/machine-learning/>machine learning</a></li>
<li><a href=https://yanirs.github.io/yanirseroussi.com/tags/predictive-modelling/>predictive modelling</a></li>
<li><a href=https://yanirs.github.io/yanirseroussi.com/tags/recommender-systems/>recommender systems</a></li>
<li><a href=https://yanirs.github.io/yanirseroussi.com/tags/software-engineering/>software engineering</a></li>
</ul>
</footer><section class=comment-section>
<strong>14 comments</strong>
<a class=comment-button href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New comment on https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Comment via GitHub issue
</a>
<div class=comment-level-0 id=comment-702>
<div class=comment-header>
<a href=#comment-702>
<img class=comment-avatar src="https://www.gravatar.com/avatar/54f70981ce3758ccbfd5420bbff28df6?s=50">
<p class=comment-info>
<strong>Zygmunt</strong><br>
<small>2015-10-02 16:51:09</small>
</p>
</a>
</div>
<div class="comment-body post-content">
<p>How did you arrive at the conclusion that accuracy doesn&rsquo;t matter? The Netflix quote and chart don&rsquo;t seem connected to me. The quote refers to the massive ensembling used to achieve the challenge score threshold. The chart seems to show that you can go a long way from the baseline by improving features and models.</p>
<p>I&rsquo;d say accuracy, or more generally, score used for evaluation, doesn&rsquo;t matter <em>as long as it&rsquo;s good enough</em>. However, it&rsquo;s not that easy to arrive at &ldquo;good enough&rdquo;. Consider Spotify. I find their daily recommendations abysmal. Discover Weekly is much better, but still has room to improve.</p>
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-702&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-1 id=comment-706>
<div class=comment-header>
<a href=#comment-706>
<img class=comment-avatar src="https://www.gravatar.com/avatar/dda019c47a6183120608a6aeac2db6c5?s=50">
<p class=comment-info>
<strong>Yanir Seroussi</strong><br>
<small>2015-10-02 20:36:57</small>
</p>
</a>
</div>
<div class="comment-body post-content">
<p>I agree. I said that predictive accuracy has some importance, but it is not the only thing that matters. You&rsquo;re right about it needing to be <em>good enough</em>, where the definition of good enough is domain-dependent.</p>
<p><a href=http://cgi.csc.liv.ac.uk/~wda2001/Panel_Presentations/Lopresti/Lopresti_files/v3_document.htm target=_blank rel=nofollow>Daniel Lopresti</a> said it well years ago (he spoke about web search but it applies to recommendation scenarios where suggestions are browsable):</p>
<blockquote>
Browsing is a comfortable and powerful paradigm (the serendipity effect). Search results don't have to be very good.
Recall? Not important (as long as you get at least some good hits).
Precision? Not important (as long as at least some of the hits on the first page you return are good).
</blockquote>
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-706&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-2 id=comment-1037>
<div class=comment-header>
<a href=#comment-1037>
<img class=comment-avatar src="https://www.gravatar.com/avatar/b3fdb35b6d4d527be6adef9dd103e352?s=50">
<p class=comment-info>
<strong>flower</strong><br>
<small>2016-01-26 18:47:02</small>
</p>
</a>
</div>
<div class="comment-body post-content">
it does not clear to me why accuracy is not important in recommender and searching??
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-1037&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-3 id=comment-1038>
<div class=comment-header>
<a href=#comment-1038>
<img class=comment-avatar src="https://www.gravatar.com/avatar/dda019c47a6183120608a6aeac2db6c5?s=50">
<p class=comment-info>
<strong>Yanir Seroussi</strong><br>
<small>2016-01-26 19:21:55</small>
</p>
</a>
</div>
<div class="comment-body post-content">
<p>It is important, but its importance tends to be exaggerated to the exclusion of all other metrics. As I said in the post, things like the way you present your results (UI/UX) and novelty/serendipity are also very important. In addition, the goal of the system is often to optimise a different goal from offline accuracy, such as revenue or engagement. In such cases it is best to focus on what you want to improve rather than offline accuracy.</p>
<p>By the way, I attended a talk by Ted Dunning a few months ago, where he said that one of the most important tweaks in real-life recommender system is adding random recommendations (essentially decreasing offline accuracy). This allows the system to learn from user feedback on a wider range of items, improving performance in the long run.</p>
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-1038&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-2 id=comment-1040>
<div class=comment-header>
<a href=#comment-1040>
<img class=comment-avatar src="https://www.gravatar.com/avatar/b3fdb35b6d4d527be6adef9dd103e352?s=50">
<p class=comment-info>
<strong>flower</strong><br>
<small>2016-01-26 21:00:40</small>
</p>
</a>
</div>
<div class="comment-body post-content">
Thank you very much for your fast response.
would you please send me the ted talk&rsquo;s tilte ? so I can watch it.
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-1040&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-3 id=comment-1041>
<div class=comment-header>
<a href=#comment-1041>
<img class=comment-avatar src="https://www.gravatar.com/avatar/dda019c47a6183120608a6aeac2db6c5?s=50">
<p class=comment-info>
<strong>Yanir Seroussi</strong><br>
<small>2016-01-26 21:05:13</small>
</p>
</a>
</div>
<div class="comment-body post-content">
It&rsquo;s a talk by Ted Dunning, not a TED talk :)
Anyway, the video is here: <a href="https://www.youtube.com/watch?v=FKAFe2iN_Yw">https://www.youtube.com/watch?v=FKAFe2iN_Yw</a> (both talks in the video are excellent)
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-1041&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-0 id=comment-704>
<div class=comment-header>
<a href=#comment-704>
<img class=comment-avatar src="https://www.gravatar.com/avatar/b5a286f0ade6f558ff4cf0e3c3f9813a?s=50">
<p class=comment-info>
<strong>rriveramx</strong><br>
<small>2015-10-02 18:19:27</small>
</p>
</a>
</div>
<div class="comment-body post-content">
<p>Two points that were not discussed but I see it recurrently, at least in E-Commerce, it is how people underestimate the effort necessary to build an online realtime recommender system and overestimate its impact. Offline recommendations are enough for the majority of cases. The second one, there is an obsession with novel algorithms, when often bread and butter ALS + domain knowledge reflected in business rules bring better impact.</p>
<p>Overall, really good overview, and I fully agree with all points!</p>
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-704&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-0 id=comment-710>
<div class=comment-header>
<a href=#comment-710>
<img class=comment-avatar src="https://www.gravatar.com/avatar/8d9aba79be37c3e972c9d572ee7dc66b?s=50">
<p class=comment-info>
<strong>Francis Kim</strong><br>
<small>2015-10-04 02:32:30</small>
</p>
</a>
</div>
<div class="comment-body post-content">
This was an excellent read - would highly recommend ;) - thank you.
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-710&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-0 id=comment-1170>
<div class=comment-header>
<a href=#comment-1170>
<img class=comment-avatar src="https://www.gravatar.com/avatar/c675bbf4b77d907c484368b1c54d20c1?s=50">
<p class=comment-info>
<strong>Divyesh Patel</strong><br>
<small>2016-04-10 14:24:59</small>
</p>
</a>
</div>
<div class="comment-body post-content">
Thanks a lot for giving an awesome overview of recommender systems. Have you considered writing a textbook on the topic?
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-1170&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-1 id=comment-1171>
<div class=comment-header>
<a href=#comment-1171>
<img class=comment-avatar src="https://www.gravatar.com/avatar/dda019c47a6183120608a6aeac2db6c5?s=50">
<p class=comment-info>
<strong>Yanir Seroussi</strong><br>
<small>2016-04-10 20:38:34</small>
</p>
</a>
</div>
<div class="comment-body post-content">
Nah, there already many books out there and it&rsquo;s too much work to write another one :)
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-1171&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-0 id=comment-1227>
<div class=comment-header>
<a href=#comment-1227>
<img class=comment-avatar src="https://www.gravatar.com/avatar/488c63cf544384eec6968efeb1ee3292?s=50">
<p class=comment-info>
<strong>AA</strong><br>
<small>2016-06-12 13:25:42</small>
</p>
</a>
</div>
<div class="comment-body post-content">
Hi! Thank you for the article. It a bit much help me for my project. However, can you suggest me any book or link that can show me how to apply the algorithm in coding? I guess it a little bit difficult. I do not found any article related to application of the algorithm in coding, especially in Java because currently I&rsquo;m developing the recommender apps. I&rsquo;m stuck at the algorithm. Hope you or anyone can help. Thank you!
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-1227&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-1 id=comment-1228>
<div class=comment-header>
<a href=#comment-1228>
<img class=comment-avatar src="https://www.gravatar.com/avatar/dda019c47a6183120608a6aeac2db6c5?s=50">
<p class=comment-info>
<strong>Yanir Seroussi</strong><br>
<small>2016-06-13 02:03:18</small>
</p>
</a>
</div>
<div class="comment-body post-content">
Thank you for your comment. You can check out Mahout in Action (<a href=https://www.manning.com/books/mahout-in-action>https://www.manning.com/books/mahout-in-action</a>) or Oryx (<a href=http://oryx.io/>http://oryx.io/</a>) for some examples.
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-1228&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-0 id=comment-1489>
<div class=comment-header>
<a href=#comment-1489>
<img class=comment-avatar src="https://www.gravatar.com/avatar/b1d3ea05e634c6db0aa1d0fa57c5bad7?s=50">
<p class=comment-info>
<strong>gluemesch</strong><br>
<small>2017-03-30 09:35:33</small>
</p>
</a>
</div>
<div class="comment-body post-content">
Hi Yanir, thanks a lot for a comprehensive article on recommender systems. What I&rsquo;m interested in particular is a recommender systems for subscription box businesses, as in the case of BarkBox, Birchbox, Blue Apron, Harry’s, OwlCrate, Trunk Club, and Winc. What type of recommeder system do they use and why is beneficial?
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-1489&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
<div class=comment-level-1 id=comment-1492>
<div class=comment-header>
<a href=#comment-1492>
<img class=comment-avatar src="https://www.gravatar.com/avatar/dda019c47a6183120608a6aeac2db6c5?s=50">
<p class=comment-info>
<strong>Yanir Seroussi</strong><br>
<small>2017-03-31 08:01:35</small>
</p>
</a>
</div>
<div class="comment-body post-content">
Thanks for your comment. Unfortunately, I&rsquo;m not familiar with those businesses so I don&rsquo;t really know what recommender systems they use&mldr;
</div>
<a class="comment-button comment-button-small" href="https://github.com/yanirs/yanirseroussi.com/issues/new?title=New reply to https%3a%2f%2fyanirs.github.io%2fyanirseroussi.com%2f2015%2f10%2f02%2fthe-wonderful-world-of-recommender-systems%2f%23comment-1492&body=<!-- Post your comment here and it may get added to the site -->" rel="noopener noreferrer" target=_blank>
Reply via GitHub issue
</a>
</div>
</section>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://yanirs.github.io/yanirseroussi.com/>Yanir Seroussi | Data science and beyond</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><div class=mailing-list-container>
<form class=mailing-list action=https://tinyletter.com/yanir method=post target=popupwindow onsubmit="return window.open('https://tinyletter.com/yanir','popupwindow','scrollbars=yes,width=800,height=600'),!0">
<label for=mailing-list-email>Get new post notifications</label>
<input type=text name=email id=mailing-list-email placeholder="Email address">
<input type=hidden value=1 name=embed>
<input type=submit value=Subscribe>
</form>
</div>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>