{{/*
An embeddable lead magnet form. Annoyingly also includes ConvertKit's script, but this will be sorted later.
*/}}
{{
$dataOptions := (dict
    "settings" (dict
        "after_subscribe" (dict
            "action" "message"
            "success_message" "Success! Now check your email to get your PDF guide."
            "redirect_url" ""
        )
        "analytics" (dict
            "google" nil
            "fathom" nil
            "facebook" nil
            "segment" nil
            "pinterest" nil
            "sparkloop" nil
            "googletagmanager" nil
        )
        "modal" (dict
            "trigger" "timer"
            "scroll_percentage" nil
            "timer" 5
            "devices" "all"
            "show_once_every" 15
        )
        "powered_by" (dict
            "show" true
            "url" "https://convertkit.com/features/forms?utm_campaign=poweredby&utm_content=form&utm_medium=referral&utm_source=dynamic"
        )
        "recaptcha" (dict
            "enabled" false
        )
        "return_visitor" (dict
            "action" "show"
            "custom_content" ""
        )
        "slide_in" (dict
            "display_in" "bottom_right"
            "trigger" "timer"
            "scroll_percentage" nil
            "timer" 5
            "devices" "all"
            "show_once_every" 15
        )
        "sticky_bar" (dict
            "display_in" "top"
            "trigger" "timer"
            "scroll_percentage" nil
            "timer" 5
            "devices" "all"
            "show_once_every" 15
        )
    )
    "version" "5"
) | jsonify
}}

<div class="mailing-list-container">
  <script src="https://f.convertkit.com/ckjs/ck.5.js"></script>
  <form
    class="mailing-list seva-form formkit-form"
    action="https://app.convertkit.com/forms/6554492/subscriptions"
    method="post"
    data-sv-form="6554492"
    data-uid="26c0fa1a04"
    data-format="inline"
    data-version="5"
    data-options='{{ $dataOptions }}'
  >
    <div data-style="clean">
      <ul class="formkit-alert formkit-alert-error" data-element="errors" data-group="alert"></ul>
      <div data-element="fields" data-stacked="false">
        <label for="mailing-list-email">Get your copy by email today</label>
        <input
          id="mailing-list-email"
          name="email_address"
          aria-label="Email address"
          placeholder="Email address"
          required=""
          type="email"
        >
        {{- /* Hack: Tag form submitters. Can probably be cleaned up further.
               See https://monicalent.com/blog/2020/05/04/tag-and-segment-convertkit-hugo-gatsby/ */}}
        <fieldset
          data-group="checkboxes"
          class="formkit-7572"
          group="field"
          type="Custom"
          order="1"
          save_as="Tag"
          style="display: none"
        >
          <div data-element="tags-checkboxes" data-group="checkbox">
            <input class="formkit-checkbox" id="tag-7572-5001948" type="checkbox" name="tags[]" value="5001948" checked="checked">
            <label for="tag-7572-5001948">Data-to-AI Health Check Downloaders</label>
          </div>
        </fieldset>
        <button data-element="submit">Submit</button>
      </div>
    </div>
  </form>
</div>
