<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Questions to consider when using AI for PDF data extraction | Yanir Seroussi | Data &amp; AI for Startup Impact</title>
<meta name="keywords" content="artificial intelligence, data science, machine learning, software engineering">
<meta name="description" content="Discussing considerations that arise when attempting to automate the extraction of structured data from PDFs and similar documents.">
<meta name="author" content="Yanir Seroussi">
<link rel="canonical" href="https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/">
<meta name="google-site-verification" content="aWlue7NGcj4dQpjOKJF7YKiAvw3JuHnq6aFqX6VwWAU">
<link crossorigin="anonymous" href="/assets/css/stylesheet.aae7b8d6eabaa881f37800d50b4d8604e83f1b3aa14069aaa7e0db30a27839d7.css" integrity="sha256-que41uq6qIHzeADVC02GBOg/GzqhQGmqp&#43;DbMKJ4Odc=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://yanirseroussi.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://yanirseroussi.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://yanirseroussi.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://yanirseroussi.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://yanirseroussi.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  

<meta property="og:title" content="Questions to consider when using AI for PDF data extraction" />
<meta property="og:description" content="Discussing considerations that arise when attempting to automate the extraction of structured data from PDFs and similar documents." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/" />
<meta property="og:image" content="https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/cover.webp" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-11T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-03-11T15:53:13+10:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/cover.webp" />
<meta name="twitter:title" content="Questions to consider when using AI for PDF data extraction"/>
<meta name="twitter:description" content="Discussing considerations that arise when attempting to automate the extraction of structured data from PDFs and similar documents."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Browse Posts",
      "item": "https://yanirseroussi.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Questions to consider when using AI for PDF data extraction",
      "item": "https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Questions to consider when using AI for PDF data extraction",
  "name": "Questions to consider when using AI for PDF data extraction",
  "description": "Discussing considerations that arise when attempting to automate the extraction of structured data from PDFs and similar documents.",
  "keywords": [
    "artificial intelligence", "data science", "machine learning", "software engineering"
  ],
  "articleBody": "The jagged frontier of AI means that you can’t always know which tasks are within the capabilities of current models. One such task is the extraction of structured data from PDFs. While this is fully within the capabilities of humans, there are unique challenges in getting off-the-shelf AIs like ChatGPT to do it well. Variants of this task have come up repeatedly in my recent discussions and work, so I put together this summary of my understanding of when it makes sense to try to automate PDF data extraction with AI.\nThis post is structured as a series of questions I’d ask about a proposed project. Actual answers will depend on the specific project.\nWhat is your budget? I assume there is some business value in the extracted data. Therefore, it’s possible to estimate the dollar value of automating the manual processes that are used to extract the data. There’s a big difference between an extraction process that takes a junior employee a couple of weeks per year and one that keeps data entry specialists busy year-round. The budget determines the tools that can be used: If it’s low (e.g., in the thousands), it’s probably only worth spending a few days assessing feasibility with off-the-shelf tools like the OpenAI APIs. If it’s higher (e.g., hundreds of thousands), paying AI engineers to build a bespoke system becomes an option.\nHow sensitive is the data? If the data you’re working with isn’t sensitive (e.g., financial statements by public companies), you’re in luck: You can use the best AIs available. A month ago, it was GPT-4. Today, you have a bunch of other proprietary options. Tomorrow, who knows?\nIf the data is sensitive and can’t leave your organisation’s systems, your options are more limited. Depending on other aspects of the problem, it may mean you’re better off waiting for better open models. However, given the rate of progress in the open source AI ecosystem, assessing feasibility is about as simple as with proprietary solutions. It’s just that right now, you won’t be using the most capable models.\nHow complex are the PDFs? There’s a wide variety of documents out there. If the PDFs you’re working with can be converted to text accurately, the AI models have a good chance of being able to extract the data you’re after. If the conversion to text is insufficiently accurate, the AIs stand little chance of outperforming data entry specialists – they just don’t see the PDFs as well as we do.\nIt’s worth spending some time on this question. For example, if you’re using OpenAI’s APIs and much of the data you’re looking to extract is contained in tables within PDFs, you can first test whether you can reliably retrieve and display specific tables. Sticking with the example of financial statements, there’s a big difference between this 124-page sample from Grant Thornton and this seven-page sample from the Australian Fair Work Commission. Prompting GPT-4 (via ChatGPT Plus) to extract a table from the former PDF produced output that was only loosely-connected to the actual content. By contrast, GPT-4 perfectly reproduced tables from the latter PDF.\nIn general, perfect conversion of PDF tables to text appears to be an unsolved problem. For example, in a benchmark from last year, the best tool tested only had about 50% accuracy when applied to tables in scientific papers. However, the field keeps moving. You may get an accuracy boost by treating PDFs as images and using vision models, as recommended by the Unstructured library. Anecdotally, I found Unstructured’s table parsing to be too inaccurate, but when I used GPT-4 Vision on screenshots of the same tables it yielded much better results. It also outperformed OpenAI’s default PDF parser. Your mileage will definitely vary.\nThings get even more complicated if some of the data you’re hoping to extract is in graphs and other figures contained in the PDFs. Verifying that the PDFs are not too complex for the AI models is definitely worth doing before jumping into more elaborate data extraction tasks.\nCan the tokenised PDFs fully fit in the model’s context window? The complexity of the PDFs determines how well the AI models can see them. Their length determines how much of them the models can see at once. There’s nuance depending on whether the PDFs are fully converted to text tokens or to text and images, but the number of tokens that can be fed in (i.e., the context window) is limited with the current generation of AI models. Context windows are rapidly expanding, with Google recently releasing a million-token model (approximately 700,000 words), but there’s still a cost per token that you need to consider when building solutions.\nIf you’re working with PDFs that are larger than your context windows, you’re probably going to use retrieval-augmented generation, i.e., break the documents into chunks and feed specific chunks into the model based on the query. With some tools and APIs, this may be handled for you (e.g., with OpenAI’s Assistants). However, it introduces a source of inaccuracies that may not be acceptable for your use case.\nWhat is your teaching approach? Assuming you’re satisfied that the AIs can see enough of the PDFs well enough to provide useful answers, it’s time to test different ways of teaching them about the data extraction tasks. The question of which approaches you can test is closely tied to your budget. But even with large budgets, it’s best to start simple and only attempt more complicated approaches if the simpler ones fail. In order of implementation complexity, key teaching approaches are:\nZero-shot: Describe the task and the expected output, provide a new PDF, and see if you get the expected output. Few-shot: In addition to describing the task and expected output, also provide examples of past PDFs and their extracted outputs. Given context window limitations, this is only feasible with relatively short PDFs and simple outputs. Fine-tuning: This goes beyond the sort of prompting that has become accessible to the general population via ChatGPT. The general idea is that you can get better results by teaching the underlying model about your expected inputs and outputs. Even if you don’t have machine learning experts on your team, you may get good results by following resources such as the fine-tuning guide by OpenAI. However, success isn’t guaranteed, so it’s important to manage expectations and budgets accordingly. It may well be the case that you’re better off waiting a few months or years for new AI models, rather than investing in fine-tuning experimentation. New models are likely to make lower-effort zero/few-shot results better. Custom models: Taking a step beyond fine-tuning, building custom machine learning models may be a good match for your budget and available expertise. However, you definitely won’t be doing it to automate a low-cost-low-frequency data entry process. Implicit in the above is the availability of some training \u0026 testing data (i.e., input PDFs and expected outputs). That is, no matter what approach you follow, you’d want to have some confidence that it works beyond a few test samples – use a large representative dataset to gain confidence in your solution.\nCan the AI model understand the input structures? This is closely related to the question of PDF complexity, but worth considering separately. I’m anthropomorphising a bit by talking about AI understanding, but just as they can’t see the same as we do, their level of understanding may also be unintuitive. For example, a recent paper that proposed a fine-tuning approach to improve GPT-3.5’s table understanding made the case that general language models can’t read tables reliably because:\nNatural language texts are (1) one-directional, (2) read left-to-right, where (3) swapping two tokens will generally change the meaning of a sentence. In contrast, relational tables are (1) two-dimensional in nature with both rows and columns, (2) where reading top-to-bottom in the vertical direction for values in the same column, is crucial in many table-tasks. Furthermore, unlike text, (3) tables are largely “invariant” to row and column permutations, where swapping two rows or columns do not generally change the semantic meaning of the table.\nThis argument is compelling, but given the emergent abilities of large language models and the fact that we no longer know what goes into proprietary models beyond GPT-3.5, I wouldn’t bet on these limitations being an issue for all tabular data. Again, experimenting with your specific use case is key. If you encounter issues, it’s worth probing the models to check if they exhibit any semantic understanding beyond just reproducing the inputs.\nCan the AI model understand and produce the output structures? If you’re building custom models, it’s straightforward to get exactly the output structure you want (e.g., a complex JSON). Otherwise, if you’re prompting a language model, you need to ask nicely and hope for the best. That said, there are strategies to get models to produce the output structures you want, such as using OpenAI’s function calling or the Outlines library. However, as with the example of tabular inputs, there is a difference between being able to produce an output that conforms to a specific output schema and populating the schema with values that make semantic sense. Breaking down complex outputs to simpler structures and using prompt chaining may be helpful in some cases.\nWhat is your long-term validation approach? Assuming you successfully build an AI solution that can replace manual data entry, should you completely stop manual data extraction? As with other questions, it depends on the use case, but it’s worth considering a gradual switch to full automation. For example, you can keep the manual process for 10% of new data to verify that the whole system works as expected. This is especially worth doing when working with publicly-available datasets, as there’s a non-zero chance that the models you’re using have seen the input training data before (though they probably haven’t seen your outputs).\nAnything else? If I missed important questions, please let me know and I will update this post.\n",
  "wordCount" : "1663",
  "inLanguage": "en",
  "image":"https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/cover.webp","datePublished": "2024-03-11T00:00:00Z",
  "dateModified": "2024-03-11T15:53:13+10:00",
  "author":{
    "@type": "Person",
    "name": "Yanir Seroussi"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Yanir Seroussi | Data \u0026 AI for Startup Impact",
    "logo": {
      "@type": "ImageObject",
      "url": "https://yanirseroussi.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://yanirseroussi.com/" accesskey="h" title="Yanir Seroussi | Data &amp; AI for Startup Impact (Alt + H)">Yanir Seroussi | Data &amp; AI for Startup Impact</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <button id="menu-trigger" aria-haspopup="menu" aria-label="Menu Button">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </button>
        <ul class="menu hidden">
            <li>
                <a href="https://yanirseroussi.com/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://yanirseroussi.com/posts/" title="Writing">
                    <span>Writing</span>
                </a>
            </li>
            <li>
                <a href="https://yanirseroussi.com/talks/" title="Speaking">
                    <span>Speaking</span>
                </a>
            </li>
            <li>
                <a href="https://yanirseroussi.com/consult/" title="Consulting">
                    <span>Consulting</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Questions to consider when using AI for PDF data extraction
    </h1>
    <div class="post-meta"><span title='2024-03-11 00:00:00 +0000 UTC'>March 11, 2024</span>

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" srcset="https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/cover_hu17937675832596400300.webp 360w ,https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/cover_hu980552213446804939.webp 480w ,https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/cover_hu13113157954432675593.webp 720w ,https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/cover_hu9625951822488009251.webp 1080w ,https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/cover.webp 1200w" 
            sizes="(min-width: 768px) 720px, 100vw" src="https://yanirseroussi.com/2024/03/11/questions-to-consider-when-using-ai-for-pdf-data-extraction/cover.webp" alt="Decorative image showing a book and flying documents with an AI-themed overlay" 
            width="1200" height="630">
        
</figure>
  <div class="post-content"><p>The <a href="https://www.oneusefulthing.org/p/centaurs-and-cyborgs-on-the-jagged" target="_blank" rel="noopener">jagged frontier</a> of AI means that you can&rsquo;t always know which tasks are within the capabilities of current models. One such task is the extraction of structured data from PDFs. While this is fully within the capabilities of humans, there are unique challenges in getting off-the-shelf AIs like ChatGPT to do it well. Variants of this task have come up repeatedly in my recent discussions and work, so I put together this summary of my understanding of when it makes sense to try to automate PDF data extraction with AI.</p>
<p>This post is structured as a series of questions I&rsquo;d ask about a proposed project. Actual answers will depend on the specific project.</p>
<h2 id="what-is-your-budget">What is your budget?<a hidden class="anchor" aria-hidden="true" href="#what-is-your-budget">#</a></h2>
<p>I assume there is some business value in the extracted data. Therefore, it&rsquo;s possible to estimate the dollar value of automating the manual processes that are used to extract the data. There&rsquo;s a big difference between an extraction process that takes a junior employee a couple of weeks per year and one that keeps data entry specialists busy year-round. The budget determines the tools that can be used: If it&rsquo;s low (e.g., in the thousands), it&rsquo;s probably only worth spending a few days assessing feasibility with off-the-shelf tools like the OpenAI APIs. If it&rsquo;s higher (e.g., hundreds of thousands), paying AI engineers to build a bespoke system becomes an option.</p>
<h2 id="how-sensitive-is-the-data">How sensitive is the data?<a hidden class="anchor" aria-hidden="true" href="#how-sensitive-is-the-data">#</a></h2>
<p>If the data you&rsquo;re working with isn&rsquo;t sensitive (e.g., financial statements by public companies), you&rsquo;re in luck: You can use the best AIs available. A month ago, it was GPT-4. Today, <a href="https://simonwillison.net/2024/Mar/8/gpt-4-barrier/" target="_blank" rel="noopener">you have a bunch of other proprietary options</a>. Tomorrow, who knows?</p>
<p>If the data is sensitive and can&rsquo;t leave your organisation&rsquo;s systems, your options are more limited. Depending on other aspects of the problem, it may mean you&rsquo;re better off <a href="https://www.oneusefulthing.org/p/the-lazy-tyranny-of-the-wait-calculation" target="_blank" rel="noopener">waiting for better open models</a>. However, given the rate of progress in the open source AI ecosystem, assessing feasibility is about as simple as with proprietary solutions. It&rsquo;s just that right now, you won&rsquo;t be using the most capable models.</p>
<h2 id="how-complex-are-the-pdfs">How complex are the PDFs?<a hidden class="anchor" aria-hidden="true" href="#how-complex-are-the-pdfs">#</a></h2>
<p>There&rsquo;s a wide variety of documents out there. If the PDFs you&rsquo;re working with can be converted to text accurately, the AI models have a good chance of being able to extract the data you&rsquo;re after. If the conversion to text is insufficiently accurate, the AIs stand little chance of outperforming data entry specialists – they just don&rsquo;t see the PDFs as well as we do.</p>
<p>It&rsquo;s worth spending some time on this question. For example, if you&rsquo;re using OpenAI&rsquo;s APIs and much of the data you&rsquo;re looking to extract is contained in tables within PDFs, you can first test whether you can reliably retrieve and display specific tables. Sticking with the example of financial statements, there&rsquo;s a big difference between <a href="https://www.grantthornton.global/contentassets/5bd3489f6516406d883a7300da904e96/ifrs-example-financial-statements-2022_feb-2023.pdf" target="_blank" rel="noopener">this 124-page sample from Grant Thornton</a> and <a href="https://regorgs.fwc.gov.au/sites/default/files/migration/429/fs023-sample-financial-statements.pdf" target="_blank" rel="noopener">this seven-page sample from the Australian Fair Work Commission</a>. Prompting GPT-4 (via ChatGPT Plus) to extract a table from the former PDF produced output that was only loosely-connected to the actual content. By contrast, GPT-4 perfectly reproduced tables from the latter PDF.</p>
<p>In general, perfect conversion of PDF tables to text appears to be an unsolved problem. For example, in <a href="https://arxiv.org/pdf/2303.09957.pdf" target="_blank" rel="noopener">a benchmark from last year</a>, the best tool tested only had about 50% accuracy when applied to tables in scientific papers. However, the field keeps moving. You may get an accuracy boost by treating PDFs as images and using vision models, as <a href="https://unstructured-io.github.io/unstructured/best_practices/table_extraction_pdf.html" target="_blank" rel="noopener">recommended by the Unstructured library</a>. Anecdotally, I found Unstructured&rsquo;s table parsing to be too inaccurate, but when I used GPT-4 Vision on screenshots of the same tables it yielded much better results. It also outperformed OpenAI&rsquo;s default PDF parser. Your mileage will definitely vary.</p>
<p>Things get even more complicated if some of the data you&rsquo;re hoping to extract is in graphs and other figures contained in the PDFs. Verifying that the PDFs are not too complex <em>for the AI models</em> is definitely worth doing before jumping into more elaborate data extraction tasks.</p>
<h2 id="can-the-tokenised-pdfs-fully-fit-in-the-models-context-window">Can the tokenised PDFs fully fit in the model&rsquo;s context window?<a hidden class="anchor" aria-hidden="true" href="#can-the-tokenised-pdfs-fully-fit-in-the-models-context-window">#</a></h2>
<p>The complexity of the PDFs determines <em>how well</em> the AI models can see them. Their length determines <em>how much</em> of them the models can see at once. There&rsquo;s nuance depending on whether the PDFs are fully converted to text <a href="https://platform.openai.com/tokenizer" target="_blank" rel="noopener">tokens</a> or to text and images, but the number of tokens that can be fed in (i.e., the context window) is limited with the current generation of AI models. Context windows are rapidly expanding, with <a href="https://blog.google/technology/ai/google-gemini-next-generation-model-february-2024/" target="_blank" rel="noopener">Google recently releasing a million-token model</a> (approximately 700,000 words), but there&rsquo;s still a cost per token that you need to consider when building solutions.</p>
<p>If you&rsquo;re working with PDFs that are larger than your context windows, you&rsquo;re probably going to use retrieval-augmented generation, i.e., break the documents into chunks and feed specific chunks into the model based on the query. With some tools and APIs, this may be handled for you (e.g., with OpenAI&rsquo;s Assistants). However, it introduces a source of inaccuracies that may not be acceptable for your use case.</p>
<h2 id="what-is-your-teaching-approach">What is your teaching approach?<a hidden class="anchor" aria-hidden="true" href="#what-is-your-teaching-approach">#</a></h2>
<p>Assuming you&rsquo;re satisfied that the AIs can see enough of the PDFs well enough to provide useful answers, it&rsquo;s time to test different ways of teaching them about the data extraction tasks. The question of which approaches you can test is closely tied to your budget. But even with large budgets, it&rsquo;s best to start simple and only attempt more complicated approaches if the simpler ones fail. In order of implementation complexity, key teaching approaches are:</p>
<ul>
<li><strong>Zero-shot:</strong> Describe the task and the expected output, provide a new PDF, and see if you get the expected output.</li>
<li><strong>Few-shot:</strong> In addition to describing the task and expected output, also provide examples of past PDFs and their extracted outputs. Given context window limitations, this is only feasible with relatively short PDFs and simple outputs.</li>
<li><strong>Fine-tuning:</strong> This goes beyond the sort of prompting that has become accessible to the general population via ChatGPT. The general idea is that you can get better results by teaching the underlying model about your expected inputs and outputs. Even if you don&rsquo;t have machine learning experts on your team, you may get good results by following resources such as <a href="https://platform.openai.com/docs/guides/fine-tuning/" target="_blank" rel="noopener">the fine-tuning guide by OpenAI</a>. However, success isn&rsquo;t guaranteed, so it&rsquo;s important to manage expectations and budgets accordingly. It may well be the case that you&rsquo;re better off waiting a few months or years for new AI models, rather than investing in fine-tuning experimentation. New models are likely to make lower-effort zero/few-shot results better.</li>
<li><strong>Custom models:</strong> Taking a step beyond fine-tuning, building custom machine learning models may be a good match for your budget and available expertise. However, you definitely won&rsquo;t be doing it to automate a low-cost-low-frequency data entry process.</li>
</ul>
<p>Implicit in the above is the availability of some training &amp; testing data (i.e., input PDFs and expected outputs). That is, no matter what approach you follow, you&rsquo;d want to have some confidence that it works beyond <a href="https://jxnl.github.io/blog/writing/2024/02/05/when-to-lgtm-at-k/" target="_blank" rel="noopener">a few test samples</a> – use a large representative dataset to gain confidence in your solution.</p>
<h2 id="can-the-ai-model-understand-the-input-structures">Can the AI model understand the input structures?<a hidden class="anchor" aria-hidden="true" href="#can-the-ai-model-understand-the-input-structures">#</a></h2>
<p>This is closely related to the question of PDF complexity, but worth considering separately. I&rsquo;m anthropomorphising a bit by talking about AI <em>understanding</em>, but just as they can&rsquo;t see the same as we do, their level of understanding may also be unintuitive. For example, <a href="https://arxiv.org/pdf/2310.09263.pdf" target="_blank" rel="noopener">a recent paper</a> that proposed a fine-tuning approach to improve GPT-3.5&rsquo;s table understanding made the case that general language models can&rsquo;t read tables reliably because:</p>
<blockquote>
<p>Natural language texts are (1) one-directional, (2) read left-to-right, where (3) swapping two tokens will generally change the meaning of a sentence. In contrast, relational tables are (1) two-dimensional in nature with both rows and columns, (2) where reading top-to-bottom in the vertical direction for values in the same column, is crucial in many table-tasks. Furthermore, unlike text, (3) tables are largely &ldquo;invariant&rdquo; to row and column permutations, where swapping two rows or columns do not generally change the semantic meaning of the table.</p>
</blockquote>
<p>This argument is compelling, but given <a href="https://openreview.net/pdf?id=yzkSU5zdwD" target="_blank" rel="noopener">the emergent abilities of large language models</a> and the fact that we no longer know what goes into proprietary models beyond GPT-3.5, I wouldn&rsquo;t bet on these limitations being an issue for <em>all</em> tabular data. Again, experimenting with your specific use case is key. If you encounter issues, it&rsquo;s worth probing the models to check if they exhibit any semantic understanding beyond just reproducing the inputs.</p>
<h2 id="can-the-ai-model-understand-and-produce-the-output-structures">Can the AI model understand and produce the output structures?<a hidden class="anchor" aria-hidden="true" href="#can-the-ai-model-understand-and-produce-the-output-structures">#</a></h2>
<p>If you&rsquo;re building custom models, it&rsquo;s straightforward to get exactly the output structure you want (e.g., a complex JSON). Otherwise, if you&rsquo;re prompting a language model, you need to ask <a href="https://arxiv.org/pdf/2402.14531.pdf" target="_blank" rel="noopener">nicely</a> and hope for the best. That said, there are strategies to get models to produce the output structures you want, such as using <a href="https://platform.openai.com/docs/guides/function-calling" target="_blank" rel="noopener">OpenAI&rsquo;s function calling</a> or <a href="https://github.com/outlines-dev/outlines" target="_blank" rel="noopener">the Outlines library</a>. However, as with the example of tabular inputs, there is a difference between being able to produce an output that conforms to a specific output schema and populating the schema with values that make semantic sense. Breaking down complex outputs to simpler structures and using <a href="https://www.promptingguide.ai/techniques/prompt_chaining" target="_blank" rel="noopener">prompt chaining</a> may be helpful in some cases.</p>
<h2 id="what-is-your-long-term-validation-approach">What is your long-term validation approach?<a hidden class="anchor" aria-hidden="true" href="#what-is-your-long-term-validation-approach">#</a></h2>
<p>Assuming you successfully build an AI solution that can replace manual data entry, should you completely stop manual data extraction? As with other questions, it depends on the use case, but it&rsquo;s worth considering a gradual switch to full automation. For example, you can keep the manual process for 10% of new data to verify that the whole system works as expected. This is especially worth doing when working with publicly-available datasets, as there&rsquo;s a non-zero chance that the models you&rsquo;re using have seen the input training data before (though they probably haven&rsquo;t seen your outputs).</p>
<h2 id="anything-else">Anything else?<a hidden class="anchor" aria-hidden="true" href="#anything-else">#</a></h2>
<p>If I missed important questions, please let me know and I will update this post.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://yanirseroussi.com/tags/artificial-intelligence/">Artificial Intelligence</a></li>
      <li><a href="https://yanirseroussi.com/tags/data-science/">Data Science</a></li>
      <li><a href="https://yanirseroussi.com/tags/machine-learning/">Machine Learning</a></li>
      <li><a href="https://yanirseroussi.com/tags/software-engineering/">Software Engineering</a></li>
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Questions to consider when using AI for PDF data extraction on x"
            href="https://x.com/intent/tweet/?text=Questions%20to%20consider%20when%20using%20AI%20for%20PDF%20data%20extraction&amp;url=https%3a%2f%2fyanirseroussi.com%2f2024%2f03%2f11%2fquestions-to-consider-when-using-ai-for-pdf-data-extraction%2f&amp;hashtags=artificialintelligence%2cdatascience%2cmachinelearning%2csoftwareengineering">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Questions to consider when using AI for PDF data extraction on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fyanirseroussi.com%2f2024%2f03%2f11%2fquestions-to-consider-when-using-ai-for-pdf-data-extraction%2f&amp;title=Questions%20to%20consider%20when%20using%20AI%20for%20PDF%20data%20extraction&amp;summary=Questions%20to%20consider%20when%20using%20AI%20for%20PDF%20data%20extraction&amp;source=https%3a%2f%2fyanirseroussi.com%2f2024%2f03%2f11%2fquestions-to-consider-when-using-ai-for-pdf-data-extraction%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Questions to consider when using AI for PDF data extraction on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fyanirseroussi.com%2f2024%2f03%2f11%2fquestions-to-consider-when-using-ai-for-pdf-data-extraction%2f&title=Questions%20to%20consider%20when%20using%20AI%20for%20PDF%20data%20extraction">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Questions to consider when using AI for PDF data extraction on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fyanirseroussi.com%2f2024%2f03%2f11%2fquestions-to-consider-when-using-ai-for-pdf-data-extraction%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Questions to consider when using AI for PDF data extraction on whatsapp"
            href="https://api.whatsapp.com/send?text=Questions%20to%20consider%20when%20using%20AI%20for%20PDF%20data%20extraction%20-%20https%3a%2f%2fyanirseroussi.com%2f2024%2f03%2f11%2fquestions-to-consider-when-using-ai-for-pdf-data-extraction%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Questions to consider when using AI for PDF data extraction on telegram"
            href="https://telegram.me/share/url?text=Questions%20to%20consider%20when%20using%20AI%20for%20PDF%20data%20extraction&amp;url=https%3a%2f%2fyanirseroussi.com%2f2024%2f03%2f11%2fquestions-to-consider-when-using-ai-for-pdf-data-extraction%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Questions to consider when using AI for PDF data extraction on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Questions%20to%20consider%20when%20using%20AI%20for%20PDF%20data%20extraction&u=https%3a%2f%2fyanirseroussi.com%2f2024%2f03%2f11%2fquestions-to-consider-when-using-ai-for-pdf-data-extraction%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>

<a href="/contact/#mailing-list-email" target="_blank" aria-label="subscribe to mailing list" class="mailing-list-link" id="mailing-list-link">
  Subscribe
</a>

<script>
  
  const mailingListButton = document.getElementById("mailing-list-link");
  window.onscroll = function () {
    if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
      mailingListButton.style.visibility = "visible";
      mailingListButton.style.opacity = "1";
    } else {
      mailingListButton.style.visibility = "hidden";
      mailingListButton.style.opacity = "0";
    }
  };
</script>




<div class="mailing-list-container">
  <script src="https://f.convertkit.com/ckjs/ck.5.js"></script>
  <form
    class="mailing-list seva-form formkit-form"
    action="https://app.convertkit.com/forms/6549537/subscriptions"
    method="post"
    data-sv-form="6549537"
    data-uid="9157759fce"
    data-format="inline"
    data-version="5"
    data-options='{&#34;settings&#34;:{&#34;after_subscribe&#34;:{&#34;action&#34;:&#34;message&#34;,&#34;redirect_url&#34;:&#34;&#34;,&#34;success_message&#34;:&#34;Success! Now check your email to confirm your subscription.&#34;},&#34;recaptcha&#34;:{&#34;enabled&#34;:false},&#34;return_visitor&#34;:{&#34;action&#34;:&#34;show&#34;,&#34;custom_content&#34;:&#34;&#34;}},&#34;version&#34;:&#34;5&#34;}'
  >
    <div data-style="clean">
      <ul class="formkit-alert formkit-alert-error" data-element="errors" data-group="alert"></ul>
      <div data-element="fields" data-stacked="false">
        <label for="mailing-list-email">Get weekly posts in your mailbox</label>
        <input
          id="mailing-list-email"
          name="email_address"
          aria-label="Email address"
          placeholder="Email address"
          required=""
          type="email"
        >
        
        <button data-element="submit">Subscribe</button>
      </div>
    </div>
  </form>
  
  <div class="footer">
    Join hundreds of subscribers. No spam or AI-generated slop. Unsubscribe any time.
  </div>
  
</div>


<section class="comment-section">
  

  <p class="post-content contact-cta">
    Public comments are closed, but I love hearing from readers. Feel free to
    <a href="/contact/" target="_blank">contact me</a> with your thoughts.
  </p>

  
  
  
  

  
</section>



</article>
    </main>
    <div class="global-footer">
  <div class="footer">
    <span>Text and figures licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="noopener">CC BY-NC-ND 4.0</a> by <a href="https://yanirseroussi.com/about/">Yanir Seroussi</a>, except where noted otherwise&nbsp;&nbsp;|</span>
    <span>
      Powered by
      <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
      <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
  </div>
</div>

<script>
  
  const menuTrigger = document.querySelector("#menu-trigger");
  const menuElem = document.querySelector(".menu");
  menuTrigger.addEventListener("click", function () {
    menuElem.classList.toggle("hidden");
  });
  document.body.addEventListener('click', function (event) {
    if (!menuTrigger.contains(event.target)) {
      menuElem.classList.add("hidden");
    }
  });
</script>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
