---
title: 'Diving deeper into causality: Pearl, Kleinberg, Hill, and untested assumptions'
author: Yanir Seroussi
type: post
date: 2016-05-14T19:57:03+00:00
url: /2016/05/15/diving-deeper-into-causality-pearl-kleinberg-hill-and-untested-assumptions/
cover:
  relative: true
  image: freediving.jpg
summary: Discussing the need for untested assumptions and temporality in causal inference. Mostly based on Samantha Kleinberg's Causality, Probability, and Time.
tags:
  - causal inference
  - data science
  - insights
  - predictive modelling

---
<p class="intro-note">Background: I have previously written about <a href="https://yanirseroussi.com/2015/12/08/this-holiday-season-give-me-real-insights/">the need for real insights that address the why behind events, not only the what and how</a>. This was followed by a <a href="https://yanirseroussi.com/2016/02/14/why-you-should-stop-worrying-about-deep-learning-and-deepen-your-understanding-of-causality-instead/">fairly popular post on causality</a>, which was heavily influenced by Samantha Kleinberg's book <a href="http://www.skleinberg.org/why/" target="_blank" rel="noopener">Why: A Guide to Finding and Using Causes</a>. This post continues my exploration of the field, and is primarily based on Kleinberg's previous book: <a href="http://www.skleinberg.org/causality_book/index.html" target="_blank" rel="noopener">Causality, Probability, and Time</a>.</p>

The study of causality and causal inference is central to science in general and data science in particular. Being able to distinguish between correlation and causation is key to designing effective interventions in business, public policy, medicine, and many other fields. There are quite a few approaches to inferring causal relationships from data. In this post, I discuss some aspects of <a href="https://en.wikipedia.org/wiki/Judea_Pearl" target="_blank" rel="noopener">Judea Pearl's</a> graphical modelling approach, and how its limitations are addressed in recent work by <a href="http://www.skleinberg.org/" target="_blank" rel="noopener">Samantha Kleinberg</a>. I then finish with a brief survey of the <a href="https://en.wikipedia.org/wiki/Bradford_Hill_criteria" target="_blank" rel="noopener">Bradford Hill criteria</a> and their applicability to a key limitation of all causal inference methods: The need for untested assumptions. 

## {{< figure src="judea-pearl.jpg" caption="Judea Pearl" width="150" class="float-right" >}} Overcoming my Pearl bias

First, I must disclose that I have a personal bias in favour of Pearl's work. While I've never met him, Pearl is my academic grandfather &ndash; he was the PhD advisor of my main PhD supervisor (Ingrid Zukerman). My first serious exposure to his work was through a Sydney reading group, where we discussed parts of Pearl's approach to causal inference. Recently, I refreshed my knowledge of Pearl causality by reading <a href="http://ftp.cs.ucla.edu/pub/stat_ser/r350.pdf" target="_blank" rel="noopener">Causal inference in statistics: An overview</a>. I am by no means an expert in Pearl's huge body of work, but I think I understand enough of it to write something of use.

Pearl's theory of causality employs Bayesian networks to represent causal structures. These are directed acyclic graphs, where each vertex represents a variable, and an edge from X to Y implies that X causes Y. Pearl also introduces the `do(X)` operator, which simulates interventions by removing all the causes of X, setting it to a constant. There is much more to this theory, but two of its main contributions are the formalisation of causal concepts that are often given only a verbal treatment, and the explicit encoding of causal assumptions. These assumptions must be made by the modeller based on background knowledge, and are encoded in the graph's structure &ndash; a missing edge between two vertices indicates that there is no direct causal relationship between the two variables.

My main issue with Pearl's treatment of causality is that he doesn't explicitly handle time. While time can be encoded into Pearl's models (e.g., via dynamic Bayesian networks), there is nothing that prevents creation of models where the future causes changes in the past. A closely-related issue is that Pearl's causal models must be directed _acyclic_ graphs, making it hard to model feedback loops. For example, Pearl says that "mud does not cause rain", but this isn't true &ndash; water from mud evaporates, causing rain (which causes mud). What's true is that "mud now doesn't cause rain now" or something along these lines, which is something that must be accounted for by adding temporal information to the models.

Nonetheless, Pearl's theory is an important step forward in the study of causality. In his words, "_in the bulk of the statistical literature before 2000, causal claims rarely appear in the mathematics. They surface only in the verbal interpretation that investigators occasionally attach to certain associations, and in the verbal description with which investigators justify assumptions._" The importance of formal causal analysis cannot be overstated, as it underlies many decisions that affect our lives. However, it seems to me like there's still plenty of work to be done before causal analysis becomes as established as other statistical tools.

## {{< figure src="samantha-kleinberg.jpg" caption="Samantha Kleinberg" width="150" class="float-right" >}} Kleinberg: Addressing gaps in Pearl's work

I recently finished reading Samantha Kleinberg's <a href="http://www.skleinberg.org/causality_book/index.html" target="_blank" rel="noopener">Causality, Probability, and Time</a>. Kleinberg dedicates a good portion of the book to presenting the history of causality and discussing its many definitions. As hinted by the book's title, Kleinberg believes that one cannot discuss causality without considering time. In her words: "_One of the most critical pieces of information about causality, though &ndash; the time it takes for the cause to produce its effect &ndash; has been largely ignored by both philosophical theories and computational methods. If we do not know when the effect will occur, we have little hope of being able to act successfully using the causal relationship._" Following this assertion, Kleinberg presents a new approach to causal inference that is based on <a href="https://en.wikipedia.org/wiki/Probabilistic_CTL" target="_blank" rel="noopener">probabilistic computation tree logic (PCTL)</a>. With PCTL, one can concisely express probabilistic temporal statements. For example, if we observe a potential cause _c_ occurring at time _t_, and a possible effect _e_ occurring at time _t'_, we can use PCTL to state the hypothesis that in general, after _c_ becomes true, it takes between one and _|t'&nbsp;&#8211;&nbsp;t|_ time units for _e_ to become true with probability at least _p_, i.e., _c_ leads to _e_:

{{< figure src="pctl-cause-leads-to-effect.png" alt="PCTL cause leads to effect" >}} 

It is obvious why PCTL may be a better fit than Bayesian networks for expressing causal statements. For example, with a Bayesian network, we can easily express the statement that smoking causes lung cancer with probability 0.3, but this isn't that useful, as it doesn't tell us how long it'll take for cancer to develop. With PCTL, we can state that smoking causes lung cancer in 5-30 years with probability at least 0.3. This matches our knowledge that cancer doesn't develop immediately &ndash; one cigarette won't kill you.

One of the key concepts introduced by Kleinberg is that of **causal significance**. Calculating the causal significance of a cause _c_ to an effect _e_ relies on first identifying the set _X_ of _potential_ (or _prima facie_) causes of _e_. The set _X_ contains all discrete variables _x_ such that _E[e|x]&ne;E[e]_ and _x_ occurs earlier than _e_. Given the set _X_, the causal significance of _c_ to _e_ is the mean of _E[e|c&and;x]&nbsp;&#8211;&nbsp;E[e|&not;c&and;x]_ for all _x&ne;c_. The intuition is that if a cause _c_ is significant, its causal significance value will be high when other potential causes are held fixed. For example, if _c_ is heavy smoking and _e_ is severity of lung cancer (with _e=0_ meaning no cancer), the expected value of _e_ given _c_ is likely to be higher than the expected value of _e_ given _&not;c_, when conditioned on any other potential cause. Once causal significance has been measured, we can separate significant causes from insignificant causes by setting a threshold on causal significance values (this threshold can be inferred from the data). Significant causes are considered to be genuine if the data is stationary and the common causes of all pairs of variables have been included, which is a very strong condition that may be hard to fulfil in realistic scenarios. However, causal significance is an evolving concept &ndash; last year, Huang and Kleinberg <a href="http://www.skleinberg.org/papers/huang_flairs15.pdf" target="_blank" rel="noopener">introduced a new definition of causal significance that can be inferred faster and yield more accurate results</a>. My general feeling is that this line of research will continue to yield many interesting and useful results in coming years.

Kleinberg's work is not without its limitations. In addition to the assumptions that causal relationships are stationary and the requirement to identify all potential causes, the recently-introduced definition of causal significance also requires the relationships to be linear and additive (though this limitation may be relaxed in future work). Another issue is that most of the evaluation in the studies I've read was done on synthetic datasets. While there are some results on real-life health and finance data, I find it hard to judge the practicality of utilising Kleinberg's methods without applying them to problems that I'm more familiar with. Finally, as with other work in the field of causal inference, we need to have some degree of belief in untested assumptions to reach useful conclusions. In Kleinberg's words:

> Thus, a just so cause _is_ genuine in the case where all of the outlined assumptions hold (namely that all common causes are included, the structure is representative of the system and, when data is used, a formula satisfied by the data will be satisfied by the structure). Our _belief_ in whether a cause is genuine, in the case where it is not certain that the assumptions hold, should be proportional to how much we believe that the assumptions are true. 

## {{< figure src="austin-bradford-hill.jpg" caption="Austin Bradford Hill" width="150" class="float-right" >}} Hill: Testing untested assumptions

To the best of my knowledge, all causal inference methods rely on untested assumptions. Specifically, we can never include all the variables in the universe in our models. Therefore, any conclusions drawn are reliant on deciding what, when, and how to measure potential causes and effects. Another issue is that no matter how good and believable our modelling is, we cannot use causal inference to convince unreasonable people. For example, some people may cite divine intervention as an unmeasurable cause of anything and everything. In addition, <a href="https://en.wikipedia.org/wiki/Merchants_of_Doubt" target="_blank" rel="noopener">people with certain commercial interests</a> often try to raise doubt about well-established causal mechanisms by making unreasonable claims for evidence of various hidden factors. For example, tobacco companies used to claim that both smoking and lung cancer were caused by a common hidden factor, making the link between smoking and lung cancer a mere association.

Assuming that we are dealing with reasonable people, there's still the question of where we should get our untested assumptions from. This question is fairly old, and has been <a href="https://www.edwardtufte.com/tufte/hill" target="_blank" rel="noopener">partly answered in 1965 by Austin Bradford Hill</a>, with nine criteria that he recommended should be considered before calling an association causal:

  1. _Strength_: How strong is the association? For example, lung cancer deaths of heavy smokers are 20-30 times greater than those of non-smokers.
  2. _Consistency_: Has the association been repeatedly observed in various circumstances? For example, many different populations have exhibited an association between smoking rates and cancer.
  3. _Specificity_: Can we pin down specific instances of the effect to specific instances of the cause? Hill sees this as a nice-to-have condition rather than a must-have &ndash; cases with multiple possible causes may not fulfil the specificity requirement.
  4. _Temporality_: Do we know that _c_ leads to _e_ or are we observing them together? This is a condition that isn't always easy to fulfil, especially when dealing with feedback loops and slow processes.
  5. _Biological gradient_: Hill's focus was on medicine, and this condition refers to the association exhibiting some dose-response curve. This can be generalised to other fields, as we can expect some regularity in the effect if it is a function of the cause (though it doesn't have to be a linear function).
  6. _Plausibility_: Do we know of a mechanism that can explain how the cause brings about the effect?
  7. _Coherence_: Does the association conflict with our current knowledge? Even if it does, it isn't enough to rule out causality, as our current knowledge may be incomplete or wrong.
  8. _Experiment_: If possible, running controlled experiments may yield very powerful evidence in favour of causation.
  9. _Analogy_: Do we know of any similar cause-and-effect relationships?

Hill summarises the list of criteria (or viewpoints) with the following statements.

> Here then are nine different viewpoints from all of which we should study association before we cry causation. What I do not believe &ndash; and this has been suggested &ndash; is that we can usefully lay down some hard-and-fast rules of evidence that _must_ be obeyed before we accept cause and effect. None of my nine viewpoints can bring indisputable evidence for or against the cause-and-effect hypothesis and none can be required as a _sine qua non_. What they can do, with greater or less strength, is to help us to make up our minds on the fundamental question &ndash; is there any other way of explaining the set of facts before us, is there any other answer equally, or more, likely than cause and effect?
> 
> No formal tests of significance can answer those questions. Such tests can, and should, remind us of the effects that the play of chance can create, and they will instruct us in the likely magnitude of those effects. Beyond that they contribute nothing to the &#8216;proof' of our hypothesis. 

Hill then goes on to criticise the increased focus on statistical significance as a condition for accepting scientific papers for publication. Remembering that this was over 50 years ago, it is a bit worrying that it has taken so long for the statistical community to <a href="https://www.amstat.org/newsroom/pressreleases/P-ValueStatement.pdf" target="_blank" rel="noopener">formally acknowledge the fact that statistical significance does not imply scientific importance, or constitutes enough evidence to support a causal hypothesis</a>.

## Closing thoughts

This post has only scratched the surface of the vast field of study of causality. At this point, I feel like I've read quite a bit, and it is time to apply what I learned to real problems. I encounter questions of causality in my everyday work, but haven't fully applied formal causal inference to any problem yet. My view is that everyone needs to at least be aware of the need to consider causality, and of what it'd take to truly prove causal impact. A large proportion of what many people need in practice may be addressed by Hill's criteria, rather than by formal methods for causal analysis. Nonetheless, I will report back when I get a chance to apply formal causal inference to real datasets. Stay tuned!
